---
title: "Stampr_UD_move"
author: "Mark Thompson"
date: '2022-07-07'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Analysis of 50% UD Quintette polygons using Stampr (Long, Robertson, Nelson 2018)

Long, J., Robertson, C., Nelson, T. 2018. stampr: Spatial-Temporal Analysis of Moving Polygons in R. Journal of Statistical Software. https://doi.org/10.18637/jss.v084.c01



```{r }

##################################################################

install.packages("sp")
install.packages("sf")
install.packages("rgdal")
install.packages("stampr")
install.packages("ggplot2")
install.packages("scales")
install.packages("here")
install.packages("quickPlot")
install.packages("maptools")
install.packages("geosphere")
install.packages("viridisLite")
install.packages("ggspatial")
install.packages("terra")
install.packages("tmap")
install.packages("imager")
install.packages("ragg")
install.packages("ggrepel")

# Libraries -------------------------------------------------------------------------
library(sp)
library(sf)
library(rgdal)
library(stampr)
library(ggplot2)
library(scales)
library(here)
library(quickPlot)
library(maptools)
library(geosphere)
library(viridisLite)
library(ggspatial)
library(terra)
library(tmap)
library(imager)
library(ragg)
library(ggrepel)


```

## Retrieve the UD polygons organized by season and by study area (BM and TR)

```{r , echo=FALSE}

seasonsUD <- list()
season_UDdir <- gsub(".shp", "",dir(here("adeHRoutput_noclip","Seasons"),pattern=".shp$"))


for(i in 1:length(season_UDdir)){
  name = season_UDdir[i]
  seasonsUD[i] <- rgdal::readOGR(paste0(here("adeHRoutput_noclip","Seasons"),"/"), name)
  names(seasonsUD[i]) <- name
}

names(seasonsUD) <- season_UDdir

## organize each "SpatialPolygonsDataFrame" into a different season
# EW = Early winter, MW = Mid winter, LW = Late winter, CA = Calving, SU = Summer, RU = Rutting

BMEW <- seasonsUD[grepl("BM", names(seasonsUD)) & grepl("EW", names(seasonsUD))]
BMMW <- seasonsUD[grepl("BM", names(seasonsUD)) & grepl("MW", names(seasonsUD))]
BMLW <- seasonsUD[grepl("BM", names(seasonsUD)) & grepl("LW", names(seasonsUD))]
BMCA <- seasonsUD[grepl("BM", names(seasonsUD)) & grepl("CA", names(seasonsUD))]
BMSU <- seasonsUD[grepl("BM", names(seasonsUD)) & grepl("SU", names(seasonsUD))]
BMRU <- seasonsUD[grepl("BM", names(seasonsUD)) & grepl("RU", names(seasonsUD))]

TREW <- seasonsUD[grepl("TR", names(seasonsUD)) & grepl("EW", names(seasonsUD))]
TRMW <- seasonsUD[grepl("TR", names(seasonsUD)) & grepl("MW", names(seasonsUD))]
TRLW <- seasonsUD[grepl("TR", names(seasonsUD)) & grepl("LW", names(seasonsUD))]
TRCA <- seasonsUD[grepl("TR", names(seasonsUD)) & grepl("CA", names(seasonsUD))]
TRSU <- seasonsUD[grepl("TR", names(seasonsUD)) & grepl("SU", names(seasonsUD))]
TRRU <- seasonsUD[grepl("TR", names(seasonsUD)) & grepl("RU", names(seasonsUD))]

```

Employ the "stampr" package to plot and track the movement of the seasonal UD polygons. It works only in pairs of time1 to time2, so this organizes pairs into a time by movement sequence.


```{r , echo=FALSE}

## How many years were gathered in a study area per season? Some years there may have been too few GPS data points ( <5 ) for a UD to be created.
#season_nam <- c("EW", "MW", "LW" , "CA" , "SU" , "RU")

CCBS_EW <- seasonsUD[grepl("BM", names(seasonsUD)) & grepl("EW", names(seasonsUD))]
CCBS_MW <- seasonsUD[grepl("BM", names(seasonsUD)) & grepl("MW", names(seasonsUD))]
CCBS_LW <- seasonsUD[grepl("BM", names(seasonsUD)) & grepl("LW", names(seasonsUD))]
CCBS_CA <- seasonsUD[grepl("BM", names(seasonsUD)) & grepl("CA", names(seasonsUD))]
CCBS_SU <- seasonsUD[grepl("BM", names(seasonsUD)) & grepl("SU", names(seasonsUD))]
CCBS_RU <- seasonsUD[grepl("BM", names(seasonsUD)) & grepl("RU", names(seasonsUD))]

BKRQ_EW <- seasonsUD[grepl("TR", names(seasonsUD)) & grepl("EW", names(seasonsUD))]
BKRQ_MW <- seasonsUD[grepl("TR", names(seasonsUD)) & grepl("MW", names(seasonsUD))]
BKRQ_LW <- seasonsUD[grepl("TR", names(seasonsUD)) & grepl("LW", names(seasonsUD))]
BKRQ_CA <- seasonsUD[grepl("TR", names(seasonsUD)) & grepl("CA", names(seasonsUD))]
BKRQ_SU <- seasonsUD[grepl("TR", names(seasonsUD)) & grepl("SU", names(seasonsUD))]
BKRQ_RU <- seasonsUD[grepl("TR", names(seasonsUD)) & grepl("RU", names(seasonsUD))]

## These are SpatialDataFramePolygons in a list, so I am using list() instead of lapply() for now.
years <- c("2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020", "2021")

BM_sUDs <- list(CCBS_EW, CCBS_MW, CCBS_LW, CCBS_CA, CCBS_SU, CCBS_RU)
BM_sUDsn <- c("CCBS_EW", "CCBS_MW", "CCBS_LW", "CCBS_CA", "CCBS_SU", "CCBS_RU")
BM_chSum <- list()
BM_chname <- list()
lc = 1

for(n in 1:length(BM_sUDs)){
  for(y in 1:length(BM_sUDs[[n]])){
    if(y < length(BM_sUDs[[n]])-1){
      x1 <- BM_sUDs[[n]][[y]]
      x2 <- BM_sUDs[[n]][[y+1]]
      x1$ID <-1
      x2$ID <-2
      BM_chSum[[lc]] <- assign(paste0(BM_sUDsn[n],"_",substr(names(BM_sUDs[[n]][y]), 8, 11)),stamp(x1, x2, direction = FALSE, distance = FALSE, shape=FALSE))
      BM_chname[lc] <- paste0(BM_sUDsn[n],"_",substr(names(BM_sUDs[[n]][y]), 8, 11))
      lc = lc+1}else{next()}
  }
}

BM_chSum_df <- unlist(BM_chSum)
names(BM_chSum_df) <- unlist(BM_chname)

TR_sUDs <- list(BKRQ_EW, BKRQ_MW, BKRQ_LW, BKRQ_CA, BKRQ_SU, BKRQ_RU)
TR_sUDsn <- c("BKRQ_EW", "BKRQ_MW", "BKRQ_LW", "BKRQ_CA", "BKRQ_SU", "BKRQ_RU")
TR_chSum <- list()
TR_chname <- list()
lc = 1

for(n in 1:length(TR_sUDs)){
  for(y in 1:length(TR_sUDs[[n]])){
    if(y < length(TR_sUDs[[n]])-1){
      x1 <- TR_sUDs[[n]][[y]]
      x2 <- TR_sUDs[[n]][[y+1]]
      x1$ID <-1
      x2$ID <-2
      TR_chSum[[lc]] <- assign(paste0(TR_sUDsn[n],"_",substr(names(TR_sUDs[[n]][y]), 8, 11)),stamp(x1, x2,direction = TRUE, distance = TRUE))
      TR_chname[lc] <- paste0(TR_sUDsn[n],"_",substr(names(TR_sUDs[[n]][y]), 8, 11))
      lc = lc+1}else{next()}
  }
}

TR_chSum_df <- unlist(TR_chSum)
names(TR_chSum_df) <- unlist(TR_chname)
TR_chSum2 <- as.list(TR_chSum_df)

cx <- stamp.group.summary(TR_chSum2[[1]])
stamp.map(TR_chSum2[[1]], by = "LEV1", main=names(TR_chSum2[1]))


```

Expansion plots
```{r , echo=FALSE}

### CCBS - BM, EW expansion contraction
### These should be apply or looped in, but in a rush I slopply did it this way. Sorry for the long code, but it works.

## Confirm the number of rows is always 1 for each:
for(i in 1:length(BMEW)){print(nrow(BMEW[[i]]))}

AE_BMWE <- data.frame(aEXPN = 1, AREA = 1)

 BMEW[[1]]$ID <- 1
 BMEW[[2]]$ID <- 2
 
ch <- stamp(BMEW[[1]], BMEW[[2]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]


AE_BMWE[1,1] = (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[1,2] = (chSum$aCONT / chSum$AREA) * 100

###
 BMEW[[2]]$ID <- 1
 BMEW[[3]]$ID <- 2
 
ch <- stamp(BMEW[[2]], BMEW[[3]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[2,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[2,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# BMEW[[3]]$ID <- 1
# BMEW[[4]]$ID <- 2
 
#ch <- stamp(BMEW[[3]], BMEW[[4]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_BMWE[2,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_BMWE[2,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMEW[[4]]$ID <- 1
 BMEW[[5]]$ID <- 2
 
ch <- stamp(BMEW[[5]], BMEW[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[3,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[3,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMEW[[5]]$ID <- 1
 BMEW[[6]]$ID <- 2
 
ch <- stamp(BMEW[[5]], BMEW[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[4,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[4,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMEW[[6]]$ID <- 1
 BMEW[[7]]$ID <- 2
 
ch <- stamp(BMEW[[5]], BMEW[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[5,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[6,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMEW[[7]]$ID <- 1
 BMEW[[8]]$ID <- 2
 
ch <- stamp(BMEW[[7]], BMEW[[8]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[6,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[6,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMEW[[8]]$ID <- 1
 BMEW[[9]]$ID <- 2
 
ch <- stamp(BMEW[[8]], BMEW[[9]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[7,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[7,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMEW[[9]]$ID <- 1
 BMEW[[10]]$ID <- 2
 
ch <- stamp(BMEW[[9]], BMEW[[10]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[8,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[8,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMEW[[10]]$ID <- 1
 BMEW[[11]]$ID <- 2
 
ch <- stamp(BMEW[[10]], BMEW[[11]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[9,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[9,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMEW[[11]]$ID <- 1
 BMEW[[12]]$ID <- 2
 
ch <- stamp(BMEW[[11]], BMEW[[12]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# BMEW[[12]]$ID <- 1
# BMEW[[13]]$ID <- 2
 
#ch <- stamp(BMEW[[12]], BMEW[[13]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]
#
#AE_BMWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_BMWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMEW[[13]]$ID <- 1
 BMEW[[14]]$ID <- 2
 
ch <- stamp(BMEW[[13]], BMEW[[14]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[11,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[11,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# BMEW[[14]]$ID <- 1
# BMEW[[15]]$ID <- 2
 
#ch <- stamp(BMEW[[14]], BMEW[[15]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_BMWE[11,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_BMWE[11,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMEW[[15]]$ID <- 1
 BMEW[[16]]$ID <- 2
 
ch <- stamp(BMEW[[15]], BMEW[[16]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMEW[[16]]$ID <- 1
 BMEW[[17]]$ID <- 2
 
ch <- stamp(BMEW[[16]], BMEW[[17]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[13,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[13,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMEW[[17]]$ID <- 1
 BMEW[[18]]$ID <- 2
 
ch <- stamp(BMEW[[17]], BMEW[[18]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[14,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[14,2] <- (chSum$aCONT / chSum$AREA) * 100

rownames(AE_BMWE) = c("03-04", "04-05", "06-07", "07-08", "08-09", "09-10", "10-11", "11-12", "12-13", "13-14", "15-16", "17-18", "18-19", "19-20")

pCCBS_EW <- ggplot(AE_BMWE, aes(aEXPN, AREA, label = rownames(AE_BMWE))) +
  geom_point(color = "red") + geom_text_repel()  +
   ggtitle("Expansion and contraction CCBS, EW") +labs(y= "% Expansion ", x = "% Contraction") + theme_classic()


###############################################################
## BMMW

AE_BMWE <- data.frame(aEXPN = 1, AREA = 1)

# BMMW[[1]]$ID <- 1
# BMMW[[2]]$ID <- 2
 
#ch <- stamp(BMMW[[1]], BMMW[[2]],direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]
#
#AE_BMWE <- data.frame(aEXPN = 1, AREA = 1)
#
#AE_BMWE[1,1] = (chSum$aEXPN / chSum$AREA) * 100
#AE_BMWE[1,2] = (chSum$aCONT / chSum$AREA) * 100

###
 BMMW[[2]]$ID <- 1
 BMMW[[3]]$ID <- 2
 
ch <- stamp(BMMW[[2]], BMMW[[3]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[2,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[2,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMMW[[3]]$ID <- 1
 BMMW[[4]]$ID <- 2
 
ch <- stamp(BMMW[[3]], BMMW[[4]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[3,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[3,2] <- (chSum$aCONT / chSum$AREA) * 100


###
 BMMW[[5]]$ID <- 1
 BMMW[[6]]$ID <- 2
 
ch <- stamp(BMMW[[5]], BMMW[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[4,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[4,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMMW[[7]]$ID <- 1
 BMMW[[8]]$ID <- 2
 
ch <- stamp(BMMW[[7]], BMMW[[8]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[5,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[5,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMMW[[8]]$ID <- 1
 BMMW[[9]]$ID <- 2
 
ch <- stamp(BMMW[[8]], BMMW[[9]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[6,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[6,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMMW[[9]]$ID <- 1
 BMMW[[10]]$ID <- 2
 
ch <- stamp(BMMW[[9]], BMMW[[10]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[7,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[7,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMMW[[10]]$ID <- 1
 BMMW[[11]]$ID <- 2
 
ch <- stamp(BMMW[[10]], BMMW[[11]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[8,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[8,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMMW[[11]]$ID <- 1
 BMMW[[12]]$ID <- 2
 
ch <- stamp(BMMW[[11]], BMMW[[12]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[9,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[9,2] <- (chSum$aCONT / chSum$AREA) * 100

###
BMMW[[12]]$ID <- 1
BMMW[[13]]$ID <- 2
 
ch <- stamp(BMMW[[12]], BMMW[[13]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMMW[[13]]$ID <- 1
 BMMW[[14]]$ID <- 2
 
ch <- stamp(BMMW[[13]], BMMW[[14]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[11,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[11,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# BMMW[[14]]$ID <- 1
# BMMW[[15]]$ID <- 2
# 
#ch <- stamp(BMMW[[14]], BMMW[[15]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]
#
#AE_BMWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_BMWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# BMMW[[15]]$ID <- 1
# BMMW[[16]]$ID <- 2
 
#ch <- stamp(BMMW[[15]], BMMW[[16]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_BMWE[13,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_BMWE[13,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMMW[[16]]$ID <- 1
 BMMW[[17]]$ID <- 2
 
ch <- stamp(BMMW[[16]], BMMW[[17]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[13,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[13,2] <- (chSum$aCONT / chSum$AREA) * 100

AE_BMWE <- AE_BMWE[c(2:11,13),]

rownames(AE_BMWE) = c("04-05", "05-06", "06-07", "07-08", "09-10", "10-11", "11-12", "13-14", "14-15", "15-16", "18-19")

pCCBS_MW <- ggplot(AE_BMWE, aes(aEXPN, AREA, label = rownames(AE_BMWE))) +
  geom_point(color = "red") + geom_text_repel()  +
   ggtitle("Expansion and contraction CCBS, MW") +labs(y= "% Expansion ", x = "% Contraction") + theme_classic()

###########################################

###############################################################
## BMLW

AE_BMWE <- data.frame(aEXPN = 1, AREA = 1)

# BMLW[[1]]$ID <- 1
# BMLW[[2]]$ID <- 2
 
#ch <- stamp(BMLW[[1]], BMLW[[2]],direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_BMWE[1,1] = (chSum$aEXPN / chSum$AREA) * 100
#AE_BMWE[1,2] = (chSum$aCONT / chSum$AREA) * 100

###
 BMLW[[2]]$ID <- 1
 BMLW[[3]]$ID <- 2
 
ch <- stamp(BMLW[[2]], BMLW[[3]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[2,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[2,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMLW[[3]]$ID <- 1
 BMLW[[4]]$ID <- 2
 
ch <- stamp(BMLW[[3]], BMLW[[4]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[3,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[3,2] <- (chSum$aCONT / chSum$AREA) * 100


###
 BMLW[[4]]$ID <- 1
 BMLW[[5]]$ID <- 2
 
ch <- stamp(BMLW[[4]], BMLW[[5]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[4,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[4,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMLW[[5]]$ID <- 1
 BMLW[[6]]$ID <- 2
 
ch <- stamp(BMLW[[5]], BMLW[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[5,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[5,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMLW[[6]]$ID <- 1
 BMLW[[7]]$ID <- 2
 
ch <- stamp(BMLW[[6]], BMLW[[7]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[6,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[6,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMLW[[7]]$ID <- 1
 BMLW[[8]]$ID <- 2
 
ch <- stamp(BMLW[[7]], BMLW[[8]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[7,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[7,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMLW[[8]]$ID <- 1
 BMLW[[9]]$ID <- 2
 
ch <- stamp(BMLW[[8]], BMLW[[9]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[8,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[8,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMLW[[9]]$ID <- 1
 BMLW[[10]]$ID <- 2
 
ch <- stamp(BMLW[[9]], BMLW[[10]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[9,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[9,2] <- (chSum$aCONT / chSum$AREA) * 100

###
#BMLW[[10]]$ID <- 1
#BMLW[[11]]$ID <- 2
# 
#ch <- stamp(BMLW[[10]], BMLW[[11]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]
#
#AE_BMWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_BMWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMLW[[11]]$ID <- 1
 BMLW[[12]]$ID <- 2
 
ch <- stamp(BMLW[[11]], BMLW[[12]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMLW[[12]]$ID <- 1
 BMLW[[13]]$ID <- 2
 
ch <- stamp(BMLW[[12]], BMLW[[13]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[11,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[11,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMLW[[13]]$ID <- 1
 BMLW[[14]]$ID <- 2
 
ch <- stamp(BMLW[[13]], BMLW[[14]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# BMLW[[14]]$ID <- 1
# BMLW[[15]]$ID <- 2
 
#ch <- stamp(BMLW[[14]], BMLW[[15]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_BMWE[13,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_BMWE[13,2] <- (chSum$aCONT / chSum$AREA) * 100

rownames(AE_BMWE) = c("04-05", "05-06", "06-07", "07-08", "08-09", "09-10", "10-11", "11-12", "12-13", "14-15", "15-16", "16-17")

pCCBS_LW <- ggplot(AE_BMWE, aes(aEXPN, AREA, label = rownames(AE_BMWE))) +
  geom_point(color = "red") + geom_text_repel()  +
   ggtitle("Expansion and contraction CCBS, LW") +labs(y= "% Expansion ", x = "% Contraction") + theme_classic()


###############################################################
## BMCA

AE_BMWE <- data.frame(aEXPN = 1, AREA = 1)

 BMCA[[1]]$ID <- 1
 BMCA[[2]]$ID <- 2
 
ch <- stamp(BMCA[[1]], BMCA[[2]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[1,1] = (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[1,2] = (chSum$aCONT / chSum$AREA) * 100

###
 BMCA[[2]]$ID <- 1
 BMCA[[3]]$ID <- 2
 
ch <- stamp(BMCA[[2]], BMCA[[3]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[2,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[2,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMCA[[3]]$ID <- 1
 BMCA[[4]]$ID <- 2
 
ch <- stamp(BMCA[[3]], BMCA[[4]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[3,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[3,2] <- (chSum$aCONT / chSum$AREA) * 100


###
 BMCA[[4]]$ID <- 1
 BMCA[[5]]$ID <- 2
 
ch <- stamp(BMCA[[4]], BMCA[[5]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[4,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[4,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMCA[[5]]$ID <- 1
 BMCA[[6]]$ID <- 2
 
ch <- stamp(BMCA[[5]], BMCA[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[5,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[5,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMCA[[6]]$ID <- 1
 BMCA[[7]]$ID <- 2
 
ch <- stamp(BMCA[[6]], BMCA[[7]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[6,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[6,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMCA[[7]]$ID <- 1
 BMCA[[8]]$ID <- 2
 
ch <- stamp(BMCA[[7]], BMCA[[8]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[7,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[7,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMCA[[8]]$ID <- 1
 BMCA[[9]]$ID <- 2
 
ch <- stamp(BMCA[[8]], BMCA[[9]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[8,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[8,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMCA[[9]]$ID <- 1
 BMCA[[10]]$ID <- 2
 
ch <- stamp(BMCA[[9]], BMCA[[10]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[9,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[9,2] <- (chSum$aCONT / chSum$AREA) * 100

###
BMCA[[10]]$ID <- 1
BMCA[[11]]$ID <- 2
 
ch <- stamp(BMCA[[10]], BMCA[[11]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMCA[[11]]$ID <- 1
 BMCA[[12]]$ID <- 2
 
ch <- stamp(BMCA[[11]], BMCA[[12]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[11,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[11,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMCA[[12]]$ID <- 1
 BMCA[[13]]$ID <- 2
 
ch <- stamp(BMCA[[12]], BMCA[[13]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMCA[[13]]$ID <- 1
 BMCA[[14]]$ID <- 2
 
ch <- stamp(BMCA[[13]], BMCA[[14]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[13,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[13,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMCA[[14]]$ID <- 1
 BMCA[[15]]$ID <- 2
 
ch <- stamp(BMCA[[14]], BMCA[[15]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[14,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[14,2] <- (chSum$aCONT / chSum$AREA) * 100

rownames(AE_BMWE) = c("04-05", "05-06", "06-07", "07-08", "08-09", "09-10", "10-11", "11-12", "12-13", "13-14", "14-15", "15-16", "16-17", "17-18")

pCCBS_CA <- ggplot(AE_BMWE, aes(aEXPN, AREA, label = rownames(AE_BMWE))) +
  geom_point(color = "red") + geom_text_repel()  +
   ggtitle("Expansion and contraction CCBS, CA") +labs(y= "% Expansion ", x = "% Contraction") + theme_classic()

##################

###############################################################
## BMSU

AE_BMWE <- data.frame(aEXPN = 1, AREA = 1)

 BMSU[[1]]$ID <- 1
 BMSU[[2]]$ID <- 2
 
ch <- stamp(BMSU[[1]], BMSU[[2]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[1,1] = (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[1,2] = (chSum$aCONT / chSum$AREA) * 100

###
 BMSU[[2]]$ID <- 1
 BMSU[[3]]$ID <- 2
 
ch <- stamp(BMSU[[2]], BMSU[[3]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[2,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[2,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMSU[[3]]$ID <- 1
 BMSU[[4]]$ID <- 2
 
ch <- stamp(BMSU[[3]], BMSU[[4]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[3,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[3,2] <- (chSum$aCONT / chSum$AREA) * 100


###
 BMSU[[4]]$ID <- 1
 BMSU[[5]]$ID <- 2
 
ch <- stamp(BMSU[[4]], BMSU[[5]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[4,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[4,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMSU[[5]]$ID <- 1
 BMSU[[6]]$ID <- 2
 
ch <- stamp(BMSU[[5]], BMSU[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[5,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[5,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMSU[[6]]$ID <- 1
 BMSU[[7]]$ID <- 2
 
ch <- stamp(BMSU[[6]], BMSU[[7]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[6,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[6,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMSU[[7]]$ID <- 1
 BMSU[[8]]$ID <- 2
 
ch <- stamp(BMSU[[7]], BMSU[[8]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[7,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[7,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMSU[[8]]$ID <- 1
 BMSU[[9]]$ID <- 2
 
ch <- stamp(BMSU[[8]], BMSU[[9]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[8,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[8,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMSU[[9]]$ID <- 1
 BMSU[[10]]$ID <- 2
 
ch <- stamp(BMSU[[9]], BMSU[[10]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[9,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[9,2] <- (chSum$aCONT / chSum$AREA) * 100

###
BMSU[[10]]$ID <- 1
BMSU[[11]]$ID <- 2
 
ch <- stamp(BMSU[[10]], BMSU[[11]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMSU[[11]]$ID <- 1
 BMSU[[12]]$ID <- 2
 
ch <- stamp(BMSU[[11]], BMSU[[12]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[11,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[11,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMSU[[12]]$ID <- 1
 BMSU[[13]]$ID <- 2
 
ch <- stamp(BMSU[[12]], BMSU[[13]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMSU[[13]]$ID <- 1
 BMSU[[14]]$ID <- 2
 
ch <- stamp(BMSU[[13]], BMSU[[14]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[13,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[13,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMSU[[14]]$ID <- 1
 BMSU[[15]]$ID <- 2
 
ch <- stamp(BMSU[[14]], BMSU[[15]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[14,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[14,2] <- (chSum$aCONT / chSum$AREA) * 100

rownames(AE_BMWE) = c("04-05", "05-06", "06-07", "07-08", "08-09", "09-10", "10-11", "11-12", "12-13", "13-14", "14-15", "15-16", "16-17", "17-18")

pCCBS_SU <- ggplot(AE_BMWE, aes(aEXPN, AREA, label = rownames(AE_BMWE))) +
  geom_point(color = "red") + geom_text_repel()  +
   ggtitle("Expansion and contraction CCBS, SU") +labs(y= "% Expansion ", x = "% Contraction") + theme_classic()

##################

###############################################################
## BMRU

AE_BMWE <- data.frame(aEXPN = 1, AREA = 1)

 BMRU[[1]]$ID <- 1
 BMRU[[2]]$ID <- 2
 
ch <- stamp(BMRU[[1]], BMRU[[2]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[1,1] = (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[1,2] = (chSum$aCONT / chSum$AREA) * 100

###
 BMRU[[2]]$ID <- 1
 BMRU[[3]]$ID <- 2
 
ch <- stamp(BMRU[[2]], BMRU[[3]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[2,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[2,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMRU[[3]]$ID <- 1
 BMRU[[4]]$ID <- 2
 
ch <- stamp(BMRU[[3]], BMRU[[4]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[3,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[3,2] <- (chSum$aCONT / chSum$AREA) * 100


###
 BMRU[[4]]$ID <- 1
 BMRU[[5]]$ID <- 2
 
ch <- stamp(BMRU[[4]], BMRU[[5]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[4,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[4,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMRU[[5]]$ID <- 1
 BMRU[[6]]$ID <- 2
 
ch <- stamp(BMRU[[5]], BMRU[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[5,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[5,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMRU[[6]]$ID <- 1
 BMRU[[7]]$ID <- 2
 
ch <- stamp(BMRU[[6]], BMRU[[7]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[6,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[6,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMRU[[7]]$ID <- 1
 BMRU[[8]]$ID <- 2
 
ch <- stamp(BMRU[[7]], BMRU[[8]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[7,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[7,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMRU[[8]]$ID <- 1
 BMRU[[9]]$ID <- 2
 
ch <- stamp(BMRU[[8]], BMRU[[9]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[8,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[8,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMRU[[9]]$ID <- 1
 BMRU[[10]]$ID <- 2
 
ch <- stamp(BMRU[[9]], BMRU[[10]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[9,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[9,2] <- (chSum$aCONT / chSum$AREA) * 100

###
BMRU[[10]]$ID <- 1
BMRU[[11]]$ID <- 2
 
ch <- stamp(BMRU[[10]], BMRU[[11]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMRU[[11]]$ID <- 1
 BMRU[[12]]$ID <- 2
 
ch <- stamp(BMRU[[11]], BMRU[[12]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[11,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[11,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMRU[[12]]$ID <- 1
 BMRU[[13]]$ID <- 2
 
ch <- stamp(BMRU[[12]], BMRU[[13]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMRU[[13]]$ID <- 1
 BMRU[[14]]$ID <- 2
 
ch <- stamp(BMRU[[13]], BMRU[[14]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[13,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[13,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 BMRU[[14]]$ID <- 1
 BMRU[[15]]$ID <- 2
 
ch <- stamp(BMRU[[14]], BMRU[[15]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_BMWE[14,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_BMWE[14,2] <- (chSum$aCONT / chSum$AREA) * 100

rownames(AE_BMWE) = c("04-05", "05-06", "06-07", "07-08", "08-09", "09-10", "10-11", "11-12", "12-13", "13-14", "14-15", "15-16", "16-17", "17-18")

pCCBS_RU <- ggplot(AE_BMWE, aes(aEXPN, AREA, label = rownames(AE_BMWE))) +
  geom_point(color = "red") + geom_text_repel()  +
   ggtitle("Expansion and contraction CCBS, RU") +labs(y= "% Expansion ", x = "% Contraction") + theme_classic()

##################

## Trend Roman
## TREW

AE_TRWE <- data.frame(aEXPN = 1, AREA = 1)
#TREW[[1]]$ID <- 1
#TREW[[2]]$ID <- 2
 
#ch <- stamp(TREW[[1]], TREW[[2]],direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[1,1] = (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[1,2] = (chSum$aCONT / chSum$AREA) * 100

###
 TREW[[2]]$ID <- 1
 TREW[[3]]$ID <- 2
 
ch <- stamp(TREW[[2]], TREW[[3]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[1,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[1,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TREW[[3]]$ID <- 1
 TREW[[4]]$ID <- 2
 
ch <- stamp(TREW[[3]], TREW[[4]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[2,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[2,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TREW[[4]]$ID <- 1
 TREW[[5]]$ID <- 2
 
ch <- stamp(TREW[[4]], TREW[[5]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[3,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[3,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TREW[[5]]$ID <- 1
 TREW[[6]]$ID <- 2
 
ch <- stamp(TREW[[5]], TREW[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[4,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[4,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TREW[[7]]$ID <- 1
 TREW[[8]]$ID <- 2
 
ch <- stamp(TREW[[7]], TREW[[8]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[5,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[5,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TREW[[8]]$ID <- 1
 TREW[[9]]$ID <- 2
 
ch <- stamp(TREW[[8]], TREW[[9]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[6,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[6,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TREW[[9]]$ID <- 1
 TREW[[10]]$ID <- 2
 
ch <- stamp(TREW[[9]], TREW[[10]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[7,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[7,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TREW[[10]]$ID <- 1
 TREW[[11]]$ID <- 2
 
ch <- stamp(TREW[[10]], TREW[[11]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[8,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[8,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TREW[[11]]$ID <- 1
 TREW[[12]]$ID <- 2
 
ch <- stamp(TREW[[11]], TREW[[12]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[9,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[9,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TREW[[12]]$ID <- 1
 TREW[[13]]$ID <- 2
 
ch <- stamp(TREW[[12]], TREW[[13]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# TREW[[13]]$ID <- 1
# TREW[[14]]$ID <- 2
 
#ch <- stamp(TREW[[13]], TREW[[14]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[9,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[9,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# TREW[[14]]$ID <- 1
# TREW[[15]]$ID <- 2
 
#ch <- stamp(TREW[[14]], TREW[[15]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# TREW[[15]]$ID <- 1
# TREW[[16]]$ID <- 2
 
#ch <- stamp(TREW[[15]], TREW[[16]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[11,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[11,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# TREW[[16]]$ID <- 1
# TREW[[17]]$ID <- 2
 
#ch <- stamp(TREW[[16]], TREW[[17]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# TREW[[17]]$ID <- 1
# TREW[[18]]$ID <- 2
 
#ch <- stamp(TREW[[17]], TREW[[18]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100


rownames(AE_TRWE) = c("07-08", "08-09", "09-10", "10-11", "11-12", "12-13", "13-14", "14-15", "15-16", "16-17")

pBKRQ_EW <- ggplot(AE_BMWE, aes(aEXPN, AREA, label = rownames(AE_BMWE))) +
  geom_point(color = "red") + geom_text_repel()  +
   ggtitle("Expansion and contraction BKRQ, EW") +labs(y= "% Expansion ", x = "% Contraction") + theme_classic()

################
## TRMW

AE_TRWE <- data.frame(aEXPN = 1, AREA = 1)

#TRMW[[1]]$ID <- 1
#TRMW[[2]]$ID <- 2
 
#ch <- stamp(TRMW[[1]], TRMW[[2]],direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[1,1] = (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[1,2] = (chSum$aCONT / chSum$AREA) * 100

###
# TRMW[[2]]$ID <- 1
# TRMW[[3]]$ID <- 2
 
#ch <- stamp(TRMW[[2]], TRMW[[3]],direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[1,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[1,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRMW[[3]]$ID <- 1
 TRMW[[4]]$ID <- 2
 
ch <- stamp(TRMW[[3]], TRMW[[4]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[1,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[1,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRMW[[4]]$ID <- 1
 TRMW[[5]]$ID <- 2
 
ch <- stamp(TRMW[[4]], TRMW[[5]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[2,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[2,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRMW[[5]]$ID <- 1
 TRMW[[6]]$ID <- 2
 
ch <- stamp(TRMW[[5]], TRMW[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[3,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[3,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRMW[[6]]$ID <- 1
 TRMW[[7]]$ID <- 2
 
ch <- stamp(TRMW[[6]], TRMW[[7]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[4,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[4,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRMW[[7]]$ID <- 1
 TRMW[[8]]$ID <- 2
 
ch <- stamp(TRMW[[7]], TRMW[[8]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[5,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[5,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRMW[[8]]$ID <- 1
 TRMW[[9]]$ID <- 2
 
ch <- stamp(TRMW[[8]], TRMW[[9]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[6,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[6,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRMW[[9]]$ID <- 1
 TRMW[[10]]$ID <- 2
 
ch <- stamp(TRMW[[9]], TRMW[[10]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[7,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[7,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRMW[[10]]$ID <- 1
 TRMW[[11]]$ID <- 2
 
ch <- stamp(TRMW[[10]], TRMW[[11]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[8,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[8,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRMW[[11]]$ID <- 1
 TRMW[[12]]$ID <- 2
 
ch <- stamp(TRMW[[11]], TRMW[[12]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[9,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[9,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRMW[[12]]$ID <- 1
 TRMW[[13]]$ID <- 2
 
ch <- stamp(TRMW[[12]], TRMW[[13]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRMW[[13]]$ID <- 1
 TRMW[[14]]$ID <- 2
 
ch <- stamp(TRMW[[13]], TRMW[[14]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[11,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[11,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRMW[[14]]$ID <- 1
 TRMW[[15]]$ID <- 2
 
ch <- stamp(TRMW[[14]], TRMW[[15]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# TRMW[[15]]$ID <- 1
#TRMW[[16]]$ID <- 2
 
#ch <- stamp(TRMW[[15]], TRMW[[16]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[13,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[13,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# TRMW[[16]]$ID <- 1
# TRMW[[17]]$ID <- 2
 
#ch <- stamp(TRMW[[16]], TRMW[[17]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100

###
# TRMW[[17]]$ID <- 1
# TRMW[[18]]$ID <- 2
 
#ch <- stamp(TRMW[[17]], TRMW[[18]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100


rownames(AE_TRWE) = c("07-08", "08-09", "09-10", "10-11", "11-12", "12-13", "13-14", "14-15", "15-16", "16-17", "17-18", "18-19")

pBKRQ_MW <- ggplot(AE_BMWE, aes(aEXPN, AREA, label = rownames(AE_BMWE))) +
  geom_point(color = "red") + geom_text_repel()  +
   ggtitle("Expansion and contraction BKRQ, MW") +labs(y= "% Expansion ", x = "% Contraction") + theme_classic()


################
## TRLW

AE_TRWE <- data.frame(aEXPN = 1, AREA = 1)

#TRLW[[1]]$ID <- 1
#TRLW[[2]]$ID <- 2
 
#ch <- stamp(TRLW[[1]], TRLW[[2]],direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[1,1] = (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[1,2] = (chSum$aCONT / chSum$AREA) * 100

###
 TRLW[[2]]$ID <- 1
 TRLW[[3]]$ID <- 2
 
ch <- stamp(TRLW[[2]], TRLW[[3]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[1,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[1,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRLW[[3]]$ID <- 1
 TRLW[[4]]$ID <- 2
 
ch <- stamp(TRLW[[3]], TRLW[[4]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[2,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[2,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRLW[[4]]$ID <- 1
 TRLW[[5]]$ID <- 2
 
ch <- stamp(TRLW[[4]], TRLW[[5]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[3,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[3,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRLW[[5]]$ID <- 1
 TRLW[[6]]$ID <- 2
 
ch <- stamp(TRLW[[5]], TRLW[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[4,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[4,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRLW[[6]]$ID <- 1
 TRLW[[7]]$ID <- 2
 
ch <- stamp(TRLW[[6]], TRLW[[7]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[5,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[5,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRLW[[7]]$ID <- 1
 TRLW[[8]]$ID <- 2
 
ch <- stamp(TRLW[[7]], TRLW[[8]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[6,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[6,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRLW[[8]]$ID <- 1
 TRLW[[9]]$ID <- 2
 
ch <- stamp(TRLW[[8]], TRLW[[9]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[7,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[7,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRLW[[9]]$ID <- 1
 TRLW[[10]]$ID <- 2
 
ch <- stamp(TRLW[[9]], TRLW[[10]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[8,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[8,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRLW[[10]]$ID <- 1
 TRLW[[11]]$ID <- 2
 
ch <- stamp(TRLW[[10]], TRLW[[11]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[9,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[9,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRLW[[11]]$ID <- 1
 TRLW[[12]]$ID <- 2
 
ch <- stamp(TRLW[[11]], TRLW[[12]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRLW[[12]]$ID <- 1
 TRLW[[13]]$ID <- 2
 
ch <- stamp(TRLW[[12]], TRLW[[13]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[11,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[11,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRLW[[13]]$ID <- 1
 TRLW[[14]]$ID <- 2
 
ch <- stamp(TRLW[[13]], TRLW[[14]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRLW[[14]]$ID <- 1
 TRLW[[15]]$ID <- 2
 
ch <- stamp(TRLW[[14]], TRLW[[15]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[13,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[13,2] <- (chSum$aCONT / chSum$AREA) * 100

###
TRLW[[15]]$ID <- 1
TRLW[[16]]$ID <- 2
 
ch <- stamp(TRLW[[15]], TRLW[[16]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[14,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[14,2] <- (chSum$aCONT / chSum$AREA) * 100

rownames(AE_TRWE) = c("06-07", "07-08", "08-09", "09-10", "10-11", "11-12", "12-13", "13-14", "14-15", "15-16", "16-17", "17-18", "18-19", "19-20")

pBKRQ_LW <- ggplot(AE_BMWE, aes(aEXPN, AREA, label = rownames(AE_BMWE))) +
  geom_point(color = "red") + geom_text_repel()  +
   ggtitle("Expansion and contraction BKRQ, LW") +labs(y= "% Expansion ", x = "% Contraction") + theme_classic()

####
################
## TRCA

AE_TRWE <- data.frame(aEXPN = 1, AREA = 1)

#TRCA[[1]]$ID <- 1
#TRCA[[2]]$ID <- 2
 
#ch <- stamp(TRCA[[1]], TRCA[[2]],direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[1,1] = (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[1,2] = (chSum$aCONT / chSum$AREA) * 100

###
 TRCA[[2]]$ID <- 1
 TRCA[[3]]$ID <- 2
 
ch <- stamp(TRCA[[2]], TRCA[[3]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[1,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[1,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRCA[[3]]$ID <- 1
 TRCA[[4]]$ID <- 2
 
ch <- stamp(TRCA[[3]], TRCA[[4]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[2,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[2,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRCA[[4]]$ID <- 1
 TRCA[[5]]$ID <- 2
 
ch <- stamp(TRCA[[4]], TRCA[[5]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[3,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[3,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRCA[[5]]$ID <- 1
 TRCA[[6]]$ID <- 2
 
ch <- stamp(TRCA[[5]], TRCA[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[4,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[4,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRCA[[7]]$ID <- 1
 TRCA[[8]]$ID <- 2
 
ch <- stamp(TRCA[[7]], TRCA[[8]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[5,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[5,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRCA[[8]]$ID <- 1
 TRCA[[9]]$ID <- 2
 
ch <- stamp(TRCA[[8]], TRCA[[9]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[6,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[6,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRCA[[9]]$ID <- 1
 TRCA[[10]]$ID <- 2
 
ch <- stamp(TRCA[[9]], TRCA[[10]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[7,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[7,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRCA[[10]]$ID <- 1
 TRCA[[11]]$ID <- 2
 
ch <- stamp(TRCA[[10]], TRCA[[11]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[8,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[8,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRCA[[11]]$ID <- 1
 TRCA[[12]]$ID <- 2
 
ch <- stamp(TRCA[[11]], TRCA[[12]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[9,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[9,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRCA[[12]]$ID <- 1
 TRCA[[13]]$ID <- 2
 
ch <- stamp(TRCA[[12]], TRCA[[13]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRCA[[13]]$ID <- 1
 TRCA[[14]]$ID <- 2
 
ch <- stamp(TRCA[[13]], TRCA[[14]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[11,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[11,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRCA[[14]]$ID <- 1
 TRCA[[15]]$ID <- 2
 
ch <- stamp(TRCA[[14]], TRCA[[15]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100

###
#TRCA[[15]]$ID <- 1
#TRCA[[16]]$ID <- 2
 
#ch <- stamp(TRCA[[15]], TRCA[[16]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[13,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[13,2] <- (chSum$aCONT / chSum$AREA) * 100


rownames(AE_BMWE) = c("06-07", "07-08", "08-09", "09-10", "10-11", "11-12", "12-13", "13-14", "14-15", "15-16", "16-17", "17-18", "18-19", "19-20")

pBKRQ_CA <- ggplot(AE_BMWE, aes(aEXPN, AREA, label = rownames(AE_BMWE))) +
  geom_point(color = "red") + geom_text_repel()  +
   ggtitle("Expansion and contraction BKRQ, CA") +labs(y= "% Expansion ", x = "% Contraction") + theme_classic()

####
################
## TRSU

AE_TRWE <- data.frame(aEXPN = 1, AREA = 1)

#TRSU[[1]]$ID <- 1
#TRSU[[2]]$ID <- 2
 
#ch <- stamp(TRSU[[1]], TRSU[[2]],direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[1,1] = (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[1,2] = (chSum$aCONT / chSum$AREA) * 100

###
# TRSU[[2]]$ID <- 1
# TRSU[[3]]$ID <- 2
 
#ch <- stamp(TRSU[[2]], TRSU[[3]],direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[1,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[1,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRSU[[3]]$ID <- 1
 TRSU[[4]]$ID <- 2
 
ch <- stamp(TRSU[[3]], TRSU[[4]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[1,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[1,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRSU[[4]]$ID <- 1
 TRSU[[5]]$ID <- 2
 
ch <- stamp(TRSU[[4]], TRSU[[5]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[2,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[2,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRSU[[5]]$ID <- 1
 TRSU[[6]]$ID <- 2
 
ch <- stamp(TRSU[[5]], TRSU[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[3,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[3,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRSU[[6]]$ID <- 1
 TRSU[[7]]$ID <- 2
 
ch <- stamp(TRSU[[5]], TRSU[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[4,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[4,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRSU[[7]]$ID <- 1
 TRSU[[8]]$ID <- 2
 
ch <- stamp(TRSU[[7]], TRSU[[8]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[5,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[5,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRSU[[8]]$ID <- 1
 TRSU[[9]]$ID <- 2
 
ch <- stamp(TRSU[[8]], TRSU[[9]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[6,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[6,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRSU[[9]]$ID <- 1
 TRSU[[10]]$ID <- 2
 
ch <- stamp(TRSU[[9]], TRSU[[10]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[7,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[7,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRSU[[10]]$ID <- 1
 TRSU[[11]]$ID <- 2
 
ch <- stamp(TRSU[[10]], TRSU[[11]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[8,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[8,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRSU[[11]]$ID <- 1
 TRSU[[12]]$ID <- 2
 
ch <- stamp(TRSU[[11]], TRSU[[12]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[9,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[9,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRSU[[12]]$ID <- 1
 TRSU[[13]]$ID <- 2
 
ch <- stamp(TRSU[[12]], TRSU[[13]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRSU[[13]]$ID <- 1
 TRSU[[14]]$ID <- 2
 
ch <- stamp(TRSU[[13]], TRSU[[14]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[11,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[11,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRSU[[14]]$ID <- 1
 TRSU[[15]]$ID <- 2
 
ch <- stamp(TRSU[[14]], TRSU[[15]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100

###
TRSU[[15]]$ID <- 1
TRSU[[16]]$ID <- 2
 
ch <- stamp(TRSU[[15]], TRSU[[16]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[13,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[13,2] <- (chSum$aCONT / chSum$AREA) * 100


rownames(AE_TRWE) = c("07-08", "08-09", "09-10", "10-11", "11-12", "12-13", "13-14", "14-15", "15-16", "16-17", "17-18", "18-19", "19-20")

pBKRQ_SU <- ggplot(AE_BMWE, aes(aEXPN, AREA, label = rownames(AE_BMWE))) +
  geom_point(color = "red") + geom_text_repel()  +
   ggtitle("Expansion and contraction BKRQ, SU") +labs(y= "% Expansion ", x = "% Contraction") + theme_classic()



###################
## TRRU

AE_TRWE <- data.frame(aEXPN = 1, AREA = 1)

#TRRU[[1]]$ID <- 1
#TRRU[[2]]$ID <- 2
 
#ch <- stamp(TRRU[[1]], TRRU[[2]],direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[1,1] = (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[1,2] = (chSum$aCONT / chSum$AREA) * 100

###
 TRRU[[2]]$ID <- 1
 TRRU[[3]]$ID <- 2
 
ch <- stamp(TRRU[[2]], TRRU[[3]],direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[1,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[1,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRRU[[3]]$ID <- 1
 TRRU[[4]]$ID <- 2
 
ch <- stamp(TRRU[[3]], TRRU[[4]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[2,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[2,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRRU[[4]]$ID <- 1
 TRRU[[5]]$ID <- 2
 
ch <- stamp(TRRU[[4]], TRRU[[5]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[3,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[3,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRRU[[5]]$ID <- 1
 TRRU[[6]]$ID <- 2
 
ch <- stamp(TRRU[[5]], TRRU[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[4,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[4,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRRU[[6]]$ID <- 1
 TRRU[[7]]$ID <- 2
 
ch <- stamp(TRRU[[5]], TRRU[[6]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[5,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[5,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRRU[[7]]$ID <- 1
 TRRU[[8]]$ID <- 2
 
ch <- stamp(TRRU[[7]], TRRU[[8]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[6,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[6,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRRU[[8]]$ID <- 1
 TRRU[[9]]$ID <- 2
 
ch <- stamp(TRRU[[8]], TRRU[[9]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[7,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[7,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRRU[[9]]$ID <- 1
 TRRU[[10]]$ID <- 2
 
ch <- stamp(TRRU[[9]], TRRU[[10]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[8,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[8,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRRU[[10]]$ID <- 1
 TRRU[[11]]$ID <- 2
 
ch <- stamp(TRRU[[10]], TRRU[[11]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[9,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[9,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRRU[[11]]$ID <- 1
 TRRU[[12]]$ID <- 2
 
ch <- stamp(TRRU[[11]], TRRU[[12]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[10,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[10,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRRU[[12]]$ID <- 1
 TRRU[[13]]$ID <- 2
 
ch <- stamp(TRRU[[12]], TRRU[[13]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[11,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[11,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRRU[[13]]$ID <- 1
 TRRU[[14]]$ID <- 2
 
ch <- stamp(TRRU[[13]], TRRU[[14]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[12,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[12,2] <- (chSum$aCONT / chSum$AREA) * 100

###
 TRRU[[14]]$ID <- 1
 TRRU[[15]]$ID <- 2
 
ch <- stamp(TRRU[[14]], TRRU[[15]], direction = TRUE, distance = TRUE)
chSum <- stamp.group.summary(ch)
chSum <- chSum[chSum$nEVENTS > 1, ]

AE_TRWE[13,1] <- (chSum$aEXPN / chSum$AREA) * 100
AE_TRWE[13,2] <- (chSum$aCONT / chSum$AREA) * 100

###
#TRRU[[15]]$ID <- 1
#TRRU[[16]]$ID <- 2
 
#ch <- stamp(TRRU[[15]], TRRU[[16]], direction = TRUE, distance = TRUE)
#chSum <- stamp.group.summary(ch)
#chSum <- chSum[chSum$nEVENTS > 1, ]

#AE_TRWE[14,1] <- (chSum$aEXPN / chSum$AREA) * 100
#AE_TRWE[14,2] <- (chSum$aCONT / chSum$AREA) * 100


rownames(AE_TRWE) = c("07-08", "08-09", "09-10", "10-11", "11-12", "12-13", "13-14", "14-15", "15-16", "16-17", "17-18", "18-19", "19-20")

pBKRQ_RU <- ggplot(AE_BMWE, aes(aEXPN, AREA, label = rownames(AE_BMWE))) +
  geom_point(color = "red") + geom_text_repel()  +
   ggtitle("Expansion and contraction BKRQ, RU") +labs(y= "% Expansion ", x = "% Contraction") + theme_classic()

ggsave(paste0(here("Plots"),"/pCCBS_EW.jpg"), plot = pCCBS_EW)
ggsave(paste0(here("Plots"),"/pCCBS_MW.jpg"), plot = pCCBS_MW)
ggsave(paste0(here("Plots"),"/pCCBS_LW.jpg"), plot = pCCBS_LW)
ggsave(paste0(here("Plots"),"/pCCBS_CA.jpg"), plot = pCCBS_CA)
ggsave(paste0(here("Plots"),"/pCCBS_SU.jpg"), plot = pCCBS_SU)
ggsave(paste0(here("Plots"),"/pCCBS_RU.jpg"), plot = pCCBS_RU)

ggsave(paste0(here("Plots"),"/pBKRQ_EW.jpg"), plot = pBKRQ_EW)
ggsave(paste0(here("Plots"),"/pBKRQ_MW.jpg"), plot = pBKRQ_MW)
ggsave(paste0(here("Plots"),"/pBKRQ_LW.jpg"), plot = pBKRQ_LW)
ggsave(paste0(here("Plots"),"/pBKRQ_CA.jpg"), plot = pBKRQ_CA)
ggsave(paste0(here("Plots"),"/pBKRQ_SU.jpg"), plot = pBKRQ_SU)
ggsave(paste0(here("Plots"),"/pBKRQ_RU.jpg"), plot = pBKRQ_RU)
```

Plotting

```{r , echo=FALSE}

QU_All.shp <- vect(paste0(here("Spatial Data"),"/Quintette_Caribou_ProjectArea.shp"))
QU_All_SA.shp <- sf::st_as_sf(QU_All.shp)

bbox_new <- st_bbox(QU_All_SA.shp) # current bounding box

xrange <- bbox_new$xmax - bbox_new$xmin # range of x values
yrange <- bbox_new$ymax - bbox_new$ymin # range of y values

bbox_new[1] <- bbox_new[1] - (0.5 * xrange) # xmin - left
bbox_new[3] <- bbox_new[3] + (0.5 * xrange) # xmax - right
bbox_new[2] <- bbox_new[2] - (0.6 * yrange) # ymin - bottom
bbox_new[4] <- bbox_new[4] + (0.5 * yrange) # ymax - top

bbox_new <- bbox_new %>% st_as_sfc() #

QU_BM.shp <- vect(paste0(here("Spatial Data"),"/Quintette_Study_Areas_BM_Dataclip.shp"))
QU_BM_SA.shp <- sf::st_as_sf(QU_BM.shp, crs.proj)

## Bounding box for the UD maps
bbox_newBM <- st_bbox(QU_BM_SA.shp) # current bounding box

xrange <- bbox_newBM$xmax - bbox_newBM$xmin # range of x values
yrange <- bbox_newBM$ymax - bbox_newBM$ymin # range of y values

bbox_newBM[1] <- bbox_newBM[1] - (0.5 * xrange) # xmin - left
bbox_newBM[3] <- bbox_newBM[3] + (0.5 * xrange) # xmax - right
bbox_newBM[2] <- bbox_newBM[2] - (0.5 * yrange) # ymin - bottom
bbox_newBM[4] <- bbox_newBM[4] + (0.5 * yrange) # ymax - top

bbox_newBM <- bbox_newBM %>% st_as_sfc() # take the bounding box ...

## Bounding box for the UD centroid maps - slighly larger on bottom

bbox_newBMc <- st_bbox(QU_BM_SA.shp) # current bounding box

xrange <- bbox_newBMc$xmax - bbox_newBMc$xmin # range of x values
yrange <- bbox_newBMc$ymax - bbox_newBMc$ymin # range of y values

bbox_newBMc[1] <- bbox_newBMc[1] - (0.5 * xrange) # xmin - left
bbox_newBMc[3] <- bbox_newBMc[3] + (0.6 * xrange) # xmax - right
bbox_newBMc[2] <- bbox_newBMc[2] - (0.6 * yrange) # ymin - bottom
bbox_newBMc[4] <- bbox_newBMc[4] + (0.6 * yrange) # ymax - top

bbox_newBMc <- bbox_newBMc %>% st_as_sfc() # take the bounding box ...

##

QU_TR.shp <- vect(paste0(here("Spatial Data"),"/Quintette_Study_Areas_TR_Dataclip.shp"))
QU_TR_SA.shp <- sf::st_as_sf(QU_TR.shp, crs.proj)

## Bounding box for the UD maps
bbox_newTR <- st_bbox(QU_TR_SA.shp) # current bounding box

xrange <- bbox_newTR$xmax - bbox_newTR$xmin # range of x values
yrange <- bbox_newTR$ymax - bbox_newTR$ymin # range of y values

bbox_newTR[1] <- bbox_newTR[1] - (3.0 * xrange) # xmin - left
bbox_newTR[3] <- bbox_newTR[3] + (2.8 * xrange) # xmax - right
bbox_newTR[2] <- bbox_newTR[2] - (3.0 * yrange) # ymin - bottom
bbox_newTR[4] <- bbox_newTR[4] + (2.8 * yrange) # ymax - top

bbox_newTR <- bbox_newTR %>% st_as_sfc() # take the bounding box ..

## Bounding box for the UD centroid maps - These tracks go further, need a larger box
bbox_newTRc <- st_bbox(QU_TR_SA.shp) # current bounding box

xrange <- bbox_newTRc$xmax - bbox_newTRc$xmin # range of x values
yrange <- bbox_newTRc$ymax - bbox_newTRc$ymin # range of y values

bbox_newTRc[1] <- bbox_newTRc[1] - (1.4 * xrange) # xmin - left
bbox_newTRc[3] <- bbox_newTRc[3] + (0.9 * xrange) # xmax - right
bbox_newTRc[2] <- bbox_newTRc[2] - (1.7 * yrange) # ymin - bottom
bbox_newTRc[4] <- bbox_newTRc[4] + (0.9 * yrange) # ymax - top

bbox_newTRc <- bbox_newTRc %>% st_as_sfc() # take the bounding box ..

## Wrapper base layer

sUDsn <- c("EW", "MW", "LW", "CA", "RU", "SU")

for(i in 1:length(TR_sUDsn)){
  assign(paste0("WRbase_",sUDsn[i]),tm_shape(QU_All_SA.shp, bbox = bbox_new) + tm_borders() + tm_layout(frame = FALSE, main.title = paste0("Centroids of 50% UDs Tracked by Season: ", sUDsn[i]))  + tm_scale_bar(position = c("right","top")))
}


## Bullmoose
BM_sUDsn <- c("CCBS_EW", "CCBS_MW", "CCBS_LW", "CCBS_CA", "CCBS_SU", "CCBS_RU")

## Seasonal UD 50% polygons plotted over season by year.
for(i in 1:length(BM_sUDsn)){
    for(y in 1:length(BM_sUDs[[i]])){
      vir_10 <- viridis(n = length(BM_sUDs[[i]]))
      if(y < 9){
      assign(paste0(BM_sUDsn[i],"a",y),(assign(paste0("tmbase_",BM_sUDsn[i],y),tm_shape(QU_BM_SA.shp, bbox = bbox_newBM) + tm_borders() + tm_layout(frame = TRUE, main.title = paste0(BM_sUDsn[[i]], " Year: 200",y+1), main.title.size =0.8)) + assign(paste0(BM_sUDsn[i],y),tm_shape(BM_sUDs[[i]][[y]]) + tm_layout(frame = TRUE) + tm_polygons(col=vir_10[y], alpha = 0.2))))
      }
      else{
      assign(paste0(BM_sUDsn[i],"a",y),(assign(paste0("tmbase_",BM_sUDsn[i],y),tm_shape(QU_BM_SA.shp, bbox = bbox_newBM) + tm_borders() + tm_layout(frame = TRUE, main.title = paste0(BM_sUDsn[[i]], " Year: 20",y+1), main.title.size =0.8)) + assign(paste0(BM_sUDsn[i],y),tm_shape(BM_sUDs[[i]][[y]]) + tm_layout(frame = TRUE) + tm_polygons(col=vir_10[y], alpha = 0.2))))
      }
    }
}
 
## The BM base ("tmbase_BMEW"...) - stand alone study area if needed
for(i in 1:length(BM_sUDsn)){
  assign(paste0("tmbase_",BM_sUDsn[i]),tm_shape(QU_BM_SA.shp) + tm_borders())
}

## Trend Roman

TR_sUDsn <- c("BKRQ_EW", "BKRQ_MW", "BKRQ_LW", "BKRQ_CA", "BKRQ_SU", "BKRQ_RU")

## Seasonal UD 50% polygons plotted over season by year.
for(i in 1:length(TR_sUDsn)){
    for(y in 1:length(TR_sUDs[[i]])){
      vir_10 <- viridis(n = length(TR_sUDs[[i]]))
      if(y < 9){
      assign(paste0(TR_sUDsn[i],"a",y),(assign(paste0("tmbase_",TR_sUDsn[i],y),tm_shape(QU_TR_SA.shp, bbox = bbox_newTR) + tm_borders() + tm_layout(frame = TRUE, main.title = paste0(TR_sUDsn[[i]], " Year: 200",y+1), main.title.size =0.8)) + assign(paste0(TR_sUDsn[i],y),tm_shape(TR_sUDs[[i]][[y]]) + tm_layout(frame = TRUE) + tm_polygons(col=vir_10[y], alpha = 0.2))))
        }
      else{
      assign(paste0(TR_sUDsn[i],"a",y),(assign(paste0("tmbase_",TR_sUDsn[i],y),tm_shape(QU_TR_SA.shp, bbox = bbox_newTR) + tm_borders() + tm_layout(frame = TRUE, main.title = paste0(TR_sUDsn[[i]], " Year: 20",y+1), main.title.size =0.8)) + assign(paste0(TR_sUDsn[i],y),tm_shape(TR_sUDs[[i]][[y]]) + tm_layout(frame = TRUE) + tm_polygons(col=vir_10[y], alpha = 0.2))))
        
      }
      }
}

```



## Creating the UD centroids and mapping their linkages through time

```{r , echo=FALSE}
## Bullmoose
centroidL <- list()
centroidLn <- list()
clc = 1

for(i in 1:length(BM_sUDsn)){
    for(y in 1:length(BM_sUDs[[i]])){
      #assign(paste0(BM_sUDsn[i],y,"_centroid"),assign(paste0(BM_sUDsn[i],y),st_centroid(st_as_sf(BM_sUDs[[i]][[y]]))))
      centroidL[[clc]] <- st_centroid(st_as_sf(BM_sUDs[[i]][[y]]))
      centroidLn[clc] <- paste0(BM_sUDsn[i],y,"_centroid")
      clc = clc + 1
    }
}

centroidLn <- unlist(centroidLn)
names(centroidL) <- centroidLn


## Lines between centroids
ctrli <- list()
ctrnm <- list()
clc = 1

for(i in 1:length(BM_sUDsn)){
    for(y in 1:length(BM_sUDs[[i]])){
      if(clc == 95){break()}
      else{
        ctrli[[clc]] <- makeLines(as(centroidL[[clc+1]], "Spatial"), as(centroidL[[clc]], "Spatial"))
        ctrnm[[clc]] <- paste0(BM_sUDsn[i],y,"_caribouTraj")
        clc = clc + 1
        }
    }
}

ctrnm <- unlist(ctrnm)
names(ctrli) <- ctrnm


## Seasonal UD 50% polygon centroids plotted over season by year with connecing tracks.

cent_nm <- list()
clc = 1

for(i in 1:length(BM_sUDsn)){
  for(y in 1:length(BM_sUDs[[i]])){
    if(y == 1){
      assign(paste0("cen_",BM_sUDsn[i],y), tm_shape(centroidL[[clc]][2]) + tm_symbols(col = "green", size = 0.4, shape = 10) + tm_layout(frame = TRUE))
      cent_nm[[clc]] <- paste0("cen_", BM_sUDsn[i],y)
      clc = clc + 1
      next()
    }
    else{
      assign(paste0("cen_",BM_sUDsn[i],y), tm_shape(centroidL[[clc]][2]) + tm_symbols(col = "brown", size = 0.3, shape = 10)  + tm_layout(frame = TRUE))
      cent_nm[[clc]] <- paste0("cen_", BM_sUDsn[i],y)
      clc = clc + 1
    }
  }
}

cent_nm <- unlist(cent_nm)

## Putting the different seasons of lines in their own separate list so the years can be counted
lindf <- list()

for(n in 1:length(BM_sUDsn)){
  assign(paste0("lin_",BM_sUDsn[n]), ctrli[grep(BM_sUDsn[n], names(ctrli))])
  lindf[[n]] <- paste0("lin_",BM_sUDsn[n])
}

lindf <- unlist(lindf)

## Each season has to be looped separately
## BMEW
lines <- list()
clc = 1

for(i in 1:length(lin_CCBS_EW)){
    assign(paste0("cenli_CCBS_EW_",i),tm_shape(lin_CCBS_EW[[i]]) + tm_lines(col="antiquewhite4", lwd = 2, lty = "longdash") + tm_layout(frame = TRUE))
    lines[[clc]] <- paste0("cenli_CCBS_EW_",i)
    clc = clc + 1
}
BMEWlines <- unlist(lines)

## BMMW
lines <- list()
clc = 1

for(i in 1:length(lin_CCBS_MW)){
    assign(paste0("cenli_CCBS_MW_",i),tm_shape(lin_CCBS_MW[[i]]) + tm_lines(col="antiquewhite4", lwd = 2, lty = "longdash") + tm_layout(frame = TRUE))
    lines[[clc]] <- paste0("cenli_CCBS_MW_",i)
    clc = clc + 1
}
BMMWlines <- unlist(lines)

## BMLW
lines <- list()
clc = 1

for(i in 1:length(lin_CCBS_LW)){
    assign(paste0("cenli_CCBS_LW_",i),tm_shape(lin_CCBS_LW[[i]]) + tm_lines(col="antiquewhite4", lwd = 2, lty = "longdash") + tm_layout(frame = TRUE))
    lines[[clc]] <- paste0("cenli_CCBS_LW_",i)
    clc = clc + 1
}
BMLWlines <- unlist(lines)

## BMCA
lines <- list()
clc = 1

for(i in 1:length(lin_CCBS_CA)){
    assign(paste0("cenli_CCBS_CA_",i),tm_shape(lin_CCBS_CA[[i]]) + tm_lines(col="antiquewhite4", lwd = 2, lty = "longdash") + tm_layout(frame = TRUE))
    lines[[clc]] <- paste0("cenli_CCBS_CA_",i)
    clc = clc + 1
}
BMCAlines <- unlist(lines)

## BMSU
lines <- list()
clc = 1

for(i in 1:length(lin_CCBS_SU)){
    assign(paste0("cenli_CCBS_SU_",i),tm_shape(lin_CCBS_SU[[i]]) + tm_lines(col="antiquewhite4", lwd = 2, lty = "longdash") + tm_layout(frame = TRUE))
    lines[[clc]] <- paste0("cenli_CCBS_SU_",i)
    clc = clc + 1
}
BMSUlines <- unlist(lines)

## BMRU
lines <- list()
clc = 1

for(i in 1:length(lin_CCBS_RU)){
    assign(paste0("cenli_CCBS_RU_",i),tm_shape(lin_CCBS_RU[[i]]) + tm_lines(col="antiquewhite4", lwd = 2, lty = "longdash") + tm_layout(frame = TRUE))
    lines[[clc]] <- paste0("cenli_CCBS_RU_",i)
    clc = clc + 1
}
BMRUlines <- unlist(lines)


## Track base layer - Small
for(i in 1:length(BM_sUDsn)){
assign(paste0("Trackbase_",BM_sUDsn[i]),tm_shape(QU_BM_SA.shp, bbox = bbox_newBMc) + tm_borders() + tm_layout(frame = TRUE, main.title = paste0(BM_sUDsn[[i]], " Centroid Track: All Years"), main.title.size =0.8))
}

## cenli short for centroid line
## cen is centroid
centrack_CCBS_EW <- Trackbase_CCBS_EW + cenli_CCBS_EW_1 + cenli_CCBS_EW_2 + cenli_CCBS_EW_3 + cenli_CCBS_EW_4 + cenli_CCBS_EW_5 + cenli_CCBS_EW_6 + cenli_CCBS_EW_7 + cenli_CCBS_EW_8 + cenli_CCBS_EW_9 + cenli_CCBS_EW_10 + cenli_CCBS_EW_11 + cenli_CCBS_EW_12 + cenli_CCBS_EW_13 + cenli_CCBS_EW_14 + cenli_CCBS_EW_15 + cenli_CCBS_EW_16 + cenli_CCBS_EW_17 + cen_CCBS_EW1 + cen_CCBS_EW2 + cen_CCBS_EW3 + cen_CCBS_EW4 + cen_CCBS_EW5 + cen_CCBS_EW6 + cen_CCBS_EW7 + cen_CCBS_EW8 + cen_CCBS_EW9 + cen_CCBS_EW10 + cen_CCBS_EW11 + cen_CCBS_EW12 + cen_CCBS_EW13 + cen_CCBS_EW14 + cen_CCBS_EW15 + cen_CCBS_EW16 + cen_CCBS_EW17 + cen_CCBS_EW18

centrack_CCBS_MW <- Trackbase_CCBS_MW + cenli_CCBS_MW_1 + cenli_CCBS_MW_2 + cenli_CCBS_MW_3 + cenli_CCBS_MW_4 + cenli_CCBS_MW_5 + cenli_CCBS_MW_6 + cenli_CCBS_MW_7 + cenli_CCBS_MW_8 + cenli_CCBS_MW_9 + cenli_CCBS_MW_10 + cenli_CCBS_MW_11 + cenli_CCBS_MW_12 + cenli_CCBS_MW_13 + cenli_CCBS_MW_14 + cenli_CCBS_MW_15 + cenli_CCBS_MW_16 + cen_CCBS_MW1 + cen_CCBS_MW2 + cen_CCBS_MW3 + cen_CCBS_MW4 + cen_CCBS_MW5 + cen_CCBS_MW6 + cen_CCBS_MW7 + cen_CCBS_MW8 + cen_CCBS_MW9 + cen_CCBS_MW10 + cen_CCBS_MW11 + cen_CCBS_MW12 + cen_CCBS_MW13 + cen_CCBS_MW14 + cen_CCBS_MW15 + cen_CCBS_MW16 + cen_CCBS_MW17

centrack_CCBS_LW <- Trackbase_CCBS_LW + cenli_CCBS_LW_1 + cenli_CCBS_LW_2 + cenli_CCBS_LW_3 + cenli_CCBS_LW_4 + cenli_CCBS_LW_5 + cenli_CCBS_LW_6 + cenli_CCBS_LW_7 + cenli_CCBS_LW_8 + cenli_CCBS_LW_9 + cenli_CCBS_LW_10 + cenli_CCBS_LW_11 + cenli_CCBS_LW_12 + cenli_CCBS_LW_13 + cenli_CCBS_LW_14 + cenli_CCBS_LW_15 + cenli_CCBS_LW_16 + cen_CCBS_LW1 + cen_CCBS_LW2 + cen_CCBS_LW3 + cen_CCBS_LW4 + cen_CCBS_LW5 + cen_CCBS_LW6 + cen_CCBS_LW7 + cen_CCBS_LW8 + cen_CCBS_LW9 + cen_CCBS_LW10 + cen_CCBS_LW11 + cen_CCBS_LW12 + cen_CCBS_LW13 + cen_CCBS_LW14 + cen_CCBS_LW15 + cen_CCBS_LW16 + cen_CCBS_LW17


centrack_CCBS_CA <- Trackbase_CCBS_CA + cenli_CCBS_CA_1 + cenli_CCBS_CA_2 + cenli_CCBS_CA_3 + cenli_CCBS_CA_4 + cenli_CCBS_CA_5 + cenli_CCBS_CA_6 + cenli_CCBS_CA_7 + cenli_CCBS_CA_8 + cenli_CCBS_CA_9 + cenli_CCBS_CA_10 + cenli_CCBS_CA_11 + cenli_CCBS_CA_12 + cenli_CCBS_CA_13 + cenli_CCBS_CA_14 + cenli_CCBS_CA_15 + cenli_CCBS_CA_16 + cen_CCBS_CA1 + cen_CCBS_CA2 + cen_CCBS_CA3 + cen_CCBS_CA4 + cen_CCBS_CA5 + cen_CCBS_CA6 + cen_CCBS_CA7 + cen_CCBS_CA8 + cen_CCBS_CA9 + cen_CCBS_CA10 + cen_CCBS_CA11 + cen_CCBS_CA12 + cen_CCBS_CA13 + cen_CCBS_CA14 + cen_CCBS_CA15 + cen_CCBS_CA16

centrack_CCBS_SU <- Trackbase_CCBS_SU + cenli_CCBS_SU_1 + cenli_CCBS_SU_2 + cenli_CCBS_SU_3 + cenli_CCBS_SU_4 + cenli_CCBS_SU_5 + cenli_CCBS_SU_6 + cenli_CCBS_SU_7 + cenli_CCBS_SU_8 + cenli_CCBS_SU_9 + cenli_CCBS_SU_10 + cenli_CCBS_SU_11 + cenli_CCBS_SU_12 + cenli_CCBS_SU_13 + cenli_CCBS_SU_14 + cenli_CCBS_SU_15 + cenli_CCBS_SU_16 + cen_CCBS_SU1 + cen_CCBS_SU2 + cen_CCBS_SU3 + cen_CCBS_SU4 + cen_CCBS_SU5 + cen_CCBS_SU6 + cen_CCBS_SU7 + cen_CCBS_SU8 + cen_CCBS_SU9 + cen_CCBS_SU10 + cen_CCBS_SU11 + cen_CCBS_SU12 + cen_CCBS_SU13 + cen_CCBS_SU14 + cen_CCBS_SU15 + cen_CCBS_SU16

centrack_CCBS_RU <- Trackbase_CCBS_RU + cenli_CCBS_RU_1 + cenli_CCBS_RU_2 + cenli_CCBS_RU_3 + cenli_CCBS_RU_4 + cenli_CCBS_RU_5 + cen_CCBS_RU1 + cen_CCBS_RU2 + cen_CCBS_RU3 + cen_CCBS_RU4 + cen_CCBS_RU5


```



## Trend Roman centroid movements

```{r , echo=FALSE}
centroidL <- list()
centroidLn <- list()
clc = 1

for(i in 1:length(TR_sUDsn)){
    for(y in 1:length(TR_sUDs[[i]])){
      #assign(paste0(TR_sUDsn[i],y,"_centroid"),assign(paste0(TR_sUDsn[i],y),st_centroid(st_as_sf(TR_sUDs[[i]][[y]]))))
      centroidL[[clc]] <- st_centroid(st_as_sf(TR_sUDs[[i]][[y]]))
      centroidLn[clc] <- paste0(TR_sUDsn[i],y,"_centroid")
      clc = clc + 1
    }
}

centroidLn <- unlist(centroidLn)
names(centroidL) <- centroidLn


## Lines between centroids
ctrli <- list()
ctrnm <- list()
clc = 1

for(i in 1:length(TR_sUDsn)){
    for(y in 1:length(TR_sUDs[[i]])){
      if(clc == 95){break()}
      else{
        ctrli[[clc]] <- makeLines(as(centroidL[[clc+1]], "Spatial"), as(centroidL[[clc]], "Spatial"))
        ctrnm[[clc]] <- paste0(TR_sUDsn[i],y,"_caribouTraj")
        clc = clc + 1
        }
    }
}

ctrnm <- unlist(ctrnm)
names(ctrli) <- ctrnm


## Seasonal UD 50% polygon centroids plotted over season by year with connecing tracks.

cent_nm <- list()
clc = 1

for(i in 1:length(TR_sUDsn)){
  for(y in 1:length(TR_sUDs[[i]])){
    if(y == 1){
      assign(paste0("cen_",TR_sUDsn[i],y), tm_shape(centroidL[[clc]][2]) + tm_symbols(col = "green", size = 0.4, shape = 10) + tm_layout(frame = TRUE))
      cent_nm[[clc]] <- paste0("cen_", TR_sUDsn[i],y)
      clc = clc + 1
      next()
    }
    else{
      assign(paste0("cen_",TR_sUDsn[i],y), tm_shape(centroidL[[clc]][2]) + tm_symbols(col = "brown", size = 0.3, shape = 10)  + tm_layout(frame = TRUE))
      cent_nm[[clc]] <- paste0("cen_", TR_sUDsn[i],y)
      clc = clc + 1
    }
  }
}

cent_nm <- unlist(cent_nm)

## Putting the different seasons of lines in their own separate list so the years can be counted
lindf <- list()

for(n in 1:length(TR_sUDsn)){
  assign(paste0("lin_",TR_sUDsn[n]), ctrli[grep(TR_sUDsn[n], names(ctrli))])
  lindf[[n]] <- paste0("lin_",TR_sUDsn[n])
}

lindf <- unlist(lindf)

## Each season has to be looped separately
## TREW
lines <- list()
clc = 1

for(i in 1:length(lin_BKRQ_EW)){
    assign(paste0("cenli_BKRQ_EW_",i),tm_shape(lin_BKRQ_EW[[i]]) + tm_lines(col="antiquewhite4", lwd = 2, lty = "longdash") + tm_layout(frame = TRUE))
    lines[[clc]] <- paste0("cenli_BKRQ_EW_",i)
    clc = clc + 1
}
TREWlines <- unlist(lines)

## TRMW
lines <- list()
clc = 1

for(i in 1:length(lin_BKRQ_MW)){
    assign(paste0("cenli_BKRQ_MW_",i),tm_shape(lin_BKRQ_MW[[i]]) + tm_lines(col="antiquewhite4", lwd = 2, lty = "longdash") + tm_layout(frame = TRUE))
    lines[[clc]] <- paste0("cenli_BKRQ_MW_",i)
    clc = clc + 1
}
TRMWlines <- unlist(lines)

## TRLW
lines <- list()
clc = 1

for(i in 1:length(lin_BKRQ_LW)){
    assign(paste0("cenli_BKRQ_LW_",i),tm_shape(lin_BKRQ_LW[[i]]) + tm_lines(col="antiquewhite4", lwd = 2, lty = "longdash") + tm_layout(frame = TRUE))
    lines[[clc]] <- paste0("cenli_BKRQ_LW_",i)
    clc = clc + 1
}
TRLWlines <- unlist(lines)

## TRCA
lines <- list()
clc = 1

for(i in 1:length(lin_BKRQ_CA)){
    assign(paste0("cenli_BKRQ_CA_",i),tm_shape(lin_BKRQ_CA[[i]]) + tm_lines(col="antiquewhite4", lwd = 2, lty = "longdash") + tm_layout(frame = TRUE))
    lines[[clc]] <- paste0("cenli_BKRQ_CA_",i)
    clc = clc + 1
}
TRCAlines <- unlist(lines)

## TRSU
lines <- list()
clc = 1

for(i in 1:length(lin_BKRQ_SU)){
    assign(paste0("cenli_BKRQ_SU_",i),tm_shape(lin_BKRQ_SU[[i]]) + tm_lines(col="antiquewhite4", lwd = 2, lty = "longdash") + tm_layout(frame = TRUE))
    lines[[clc]] <- paste0("cenli_BKRQ_SU_",i)
    clc = clc + 1
}
TRSUlines <- unlist(lines)

## TRRU
lines <- list()
clc = 1

for(i in 1:length(lin_BKRQ_RU)){
    assign(paste0("cenli_BKRQ_RU_",i),tm_shape(lin_BKRQ_RU[[i]]) + tm_lines(col="antiquewhite4", lwd = 2, lty = "longdash") + tm_layout(frame = TRUE))
    lines[[clc]] <- paste0("cenli_BKRQ_RU_",i)
    clc = clc + 1
}
TRRUlines <- unlist(lines)

## Track base layer

for(i in 1:length(TR_sUDsn)){
assign(paste0("Trackbase_",TR_sUDsn[i]),tm_shape(QU_TR_SA.shp, bbox = bbox_newTRc) + tm_borders() + tm_layout(frame = TRUE, main.title = paste0(TR_sUDsn[[i]], " Centroid Track: All Years"), main.title.size =0.5))
}

## cenli short for centroid line
## cen is centroid
centrack_BKRQ_EW <- Trackbase_BKRQ_EW + cenli_BKRQ_EW_1 + cenli_BKRQ_EW_2 + cenli_BKRQ_EW_3 + cenli_BKRQ_EW_4 + cenli_BKRQ_EW_5 + cenli_BKRQ_EW_6 + cenli_BKRQ_EW_7 + cenli_BKRQ_EW_8 + cenli_BKRQ_EW_9 + cenli_BKRQ_EW_10 + cenli_BKRQ_EW_11 + cenli_BKRQ_EW_12 + cenli_BKRQ_EW_13 + cenli_BKRQ_EW_14 + cen_BKRQ_EW1 + cen_BKRQ_EW2 + cen_BKRQ_EW3 + cen_BKRQ_EW4 + cen_BKRQ_EW5 + cen_BKRQ_EW6 + cen_BKRQ_EW7 + cen_BKRQ_EW8 + cen_BKRQ_EW9 + cen_BKRQ_EW10 + cen_BKRQ_EW11 + cen_BKRQ_EW12 + cen_BKRQ_EW13 + cen_BKRQ_EW14 + cen_BKRQ_EW15

centrack_BKRQ_MW <- Trackbase_BKRQ_MW + cenli_BKRQ_MW_1 + cenli_BKRQ_MW_2 + cenli_BKRQ_MW_3 + cenli_BKRQ_MW_4 + cenli_BKRQ_MW_5 + cenli_BKRQ_MW_6 + cenli_BKRQ_MW_7 + cenli_BKRQ_MW_8 + cenli_BKRQ_MW_9 + cenli_BKRQ_MW_10 + cenli_BKRQ_MW_11 + cenli_BKRQ_MW_12 + cenli_BKRQ_MW_13 + cenli_BKRQ_MW_14 + cenli_BKRQ_MW_15 + cenli_BKRQ_MW_16 + cen_BKRQ_MW1 + cen_BKRQ_MW2 + cen_BKRQ_MW3 + cen_BKRQ_MW4 + cen_BKRQ_MW5 + cen_BKRQ_MW6 + cen_BKRQ_MW7 + cen_BKRQ_MW8 + cen_BKRQ_MW9 + cen_BKRQ_MW10 + cen_BKRQ_MW11 + cen_BKRQ_MW12 + cen_BKRQ_MW13 + cen_BKRQ_MW14 + cen_BKRQ_MW15 + cen_BKRQ_MW16 + cen_BKRQ_MW17

centrack_BKRQ_LW <- Trackbase_BKRQ_LW + cenli_BKRQ_LW_1 + cenli_BKRQ_LW_2 + cenli_BKRQ_LW_3 + cenli_BKRQ_LW_4 + cenli_BKRQ_LW_5 + cenli_BKRQ_LW_6 + cenli_BKRQ_LW_7 + cenli_BKRQ_LW_8 + cenli_BKRQ_LW_9 + cenli_BKRQ_LW_10 + cenli_BKRQ_LW_11 + cenli_BKRQ_LW_12 + cenli_BKRQ_LW_13 + cenli_BKRQ_LW_14 + cenli_BKRQ_LW_15 + cenli_BKRQ_LW_16 + cen_BKRQ_LW1 + cen_BKRQ_LW2 + cen_BKRQ_LW3 + cen_BKRQ_LW4 + cen_BKRQ_LW5 + cen_BKRQ_LW6 + cen_BKRQ_LW7 + cen_BKRQ_LW8 + cen_BKRQ_LW9 + cen_BKRQ_LW10 + cen_BKRQ_LW11 + cen_BKRQ_LW12 + cen_BKRQ_LW13 + cen_BKRQ_LW14 + cen_BKRQ_LW15 + cen_BKRQ_LW16

centrack_BKRQ_CA <- Trackbase_BKRQ_CA + cenli_BKRQ_CA_1 + cenli_BKRQ_CA_2 + cenli_BKRQ_CA_3 + cenli_BKRQ_CA_4 + cenli_BKRQ_CA_5 + cenli_BKRQ_CA_6 + cenli_BKRQ_CA_7 + cenli_BKRQ_CA_8 + cenli_BKRQ_CA_9 + cenli_BKRQ_CA_10 + cenli_BKRQ_CA_11 + cenli_BKRQ_CA_12 + cenli_BKRQ_CA_13 + cenli_BKRQ_CA_14 + cenli_BKRQ_CA_15 + cenli_BKRQ_CA_16 + cen_BKRQ_CA1 + cen_BKRQ_CA2 + cen_BKRQ_CA3 + cen_BKRQ_CA4 + cen_BKRQ_CA5 + cen_BKRQ_CA6 + cen_BKRQ_CA7 + cen_BKRQ_CA8 + cen_BKRQ_CA9 + cen_BKRQ_CA10 + cen_BKRQ_CA11 + cen_BKRQ_CA12 + cen_BKRQ_CA13 + cen_BKRQ_CA14 + cen_BKRQ_CA15 + cen_BKRQ_CA16

centrack_BKRQ_SU <- Trackbase_BKRQ_SU + cenli_BKRQ_SU_1 + cenli_BKRQ_SU_2 + cenli_BKRQ_SU_3 + cenli_BKRQ_SU_4 + cenli_BKRQ_SU_5 + cenli_BKRQ_SU_6 + cenli_BKRQ_SU_7 + cenli_BKRQ_SU_8 + cenli_BKRQ_SU_9 + cenli_BKRQ_SU_10 + cenli_BKRQ_SU_11 + cenli_BKRQ_SU_12 + cenli_BKRQ_SU_13 + cenli_BKRQ_SU_14 + cenli_BKRQ_SU_15 + cenli_BKRQ_SU_16 + cen_BKRQ_SU1 + cen_BKRQ_SU2 + cen_BKRQ_SU3 + cen_BKRQ_SU4 + cen_BKRQ_SU5 + cen_BKRQ_SU6 + cen_BKRQ_SU7 + cen_BKRQ_SU8 + cen_BKRQ_SU9 + cen_BKRQ_SU10 + cen_BKRQ_SU11 + cen_BKRQ_SU12 + cen_BKRQ_SU13 + cen_BKRQ_SU14 + cen_BKRQ_SU15 + cen_BKRQ_SU16

centrack_BKRQ_RU <- Trackbase_BKRQ_RU + cenli_BKRQ_RU_1 + cenli_BKRQ_RU_2 + cenli_BKRQ_RU_3 + cenli_BKRQ_RU_4 + cenli_BKRQ_RU_5 + cenli_BKRQ_RU_6 + cenli_BKRQ_RU_7 + cenli_BKRQ_RU_8 + cenli_BKRQ_RU_9 + cenli_BKRQ_RU_10 + cenli_BKRQ_RU_11 + cenli_BKRQ_RU_12 + cenli_BKRQ_RU_13 + cenli_BKRQ_RU_14 + cen_BKRQ_RU1 + cen_BKRQ_RU2 + cen_BKRQ_RU3 + cen_BKRQ_RU4 + cen_BKRQ_RU5 + cen_BKRQ_RU6 + cen_BKRQ_RU7 + cen_BKRQ_RU8 + cen_BKRQ_RU9 + cen_BKRQ_RU10 + cen_BKRQ_RU11 + cen_BKRQ_RU12 + cen_BKRQ_RU13 + cen_BKRQ_RU14

```

### Enlarged areas
```{r , echo=FALSE}
centrack_Agg_EW <- WRbase_EW + cenli_CCBS_EW_1 + cenli_CCBS_EW_2 + cenli_CCBS_EW_3 + cenli_CCBS_EW_4 + cenli_CCBS_EW_5 + cenli_CCBS_EW_6 + cenli_CCBS_EW_7 + cenli_CCBS_EW_8 + cenli_CCBS_EW_9 + cenli_CCBS_EW_10 + cenli_CCBS_EW_11 + cenli_CCBS_EW_12 + cenli_CCBS_EW_13 + cenli_CCBS_EW_14 + cenli_CCBS_EW_15 + cenli_CCBS_EW_16 + cenli_CCBS_EW_17 + cen_CCBS_EW1 + cen_CCBS_EW2 + cen_CCBS_EW3 + cen_CCBS_EW4 + cen_CCBS_EW5 + cen_CCBS_EW6 + cen_CCBS_EW7 + cen_CCBS_EW8 + cen_CCBS_EW9 + cen_CCBS_EW10 + cen_CCBS_EW11 + cen_CCBS_EW12 + cen_CCBS_EW13 + cen_CCBS_EW14 + cen_CCBS_EW15 + cen_CCBS_EW16 + cen_CCBS_EW17 + cen_CCBS_EW18 + cenli_BKRQ_EW_1 + cenli_BKRQ_EW_2 + cenli_BKRQ_EW_3 + cenli_BKRQ_EW_4 + cenli_BKRQ_EW_5 + cenli_BKRQ_EW_6 + cenli_BKRQ_EW_7 + cenli_BKRQ_EW_8 + cenli_BKRQ_EW_9 + cenli_BKRQ_EW_10 + cenli_BKRQ_EW_11 + cenli_BKRQ_EW_12 + cenli_BKRQ_EW_13 + cenli_BKRQ_EW_14 + cen_BKRQ_EW1 + cen_BKRQ_EW2 + cen_BKRQ_EW3 + cen_BKRQ_EW4 + cen_BKRQ_EW5 + cen_BKRQ_EW6 + cen_BKRQ_EW7 + cen_BKRQ_EW8 + cen_BKRQ_EW9 + cen_BKRQ_EW10 + cen_BKRQ_EW11 + cen_BKRQ_EW12 + cen_BKRQ_EW13 + cen_BKRQ_EW14 + cen_BKRQ_EW15

centrack_Agg_MW <- WRbase_MW + cenli_CCBS_MW_1 + cenli_CCBS_MW_2 + cenli_CCBS_MW_3 + cenli_CCBS_MW_4 + cenli_CCBS_MW_5 + cenli_CCBS_MW_6 + cenli_CCBS_MW_7 + cenli_CCBS_MW_8 + cenli_CCBS_MW_9 + cenli_CCBS_MW_10 + cenli_CCBS_MW_11 + cenli_CCBS_MW_12 + cenli_CCBS_MW_13 + cenli_CCBS_MW_14 + cenli_CCBS_MW_15 + cenli_CCBS_MW_16 + cen_CCBS_MW1 + cen_CCBS_MW2 + cen_CCBS_MW3 + cen_CCBS_MW4 + cen_CCBS_MW5 + cen_CCBS_MW6 + cen_CCBS_MW7 + cen_CCBS_MW8 + cen_CCBS_MW9 + cen_CCBS_MW10 + cen_CCBS_MW11 + cen_CCBS_MW12 + cen_CCBS_MW13 + cen_CCBS_MW14 + cen_CCBS_MW15 + cen_CCBS_MW16 + cen_CCBS_MW17 + cenli_BKRQ_MW_1 + cenli_BKRQ_MW_2 + cenli_BKRQ_MW_3 + cenli_BKRQ_MW_4 + cenli_BKRQ_MW_5 + cenli_BKRQ_MW_6 + cenli_BKRQ_MW_7 + cenli_BKRQ_MW_8 + cenli_BKRQ_MW_9 + cenli_BKRQ_MW_10 + cenli_BKRQ_MW_11 + cenli_BKRQ_MW_12 + cenli_BKRQ_MW_13 + cenli_BKRQ_MW_14 + cenli_BKRQ_MW_15 + cenli_BKRQ_MW_16 + cen_BKRQ_MW1 + cen_BKRQ_MW2 + cen_BKRQ_MW3 + cen_BKRQ_MW4 + cen_BKRQ_MW5 + cen_BKRQ_MW6 + cen_BKRQ_MW7 + cen_BKRQ_MW8 + cen_BKRQ_MW9 + cen_BKRQ_MW10 + cen_BKRQ_MW11 + cen_BKRQ_MW12 + cen_BKRQ_MW13 + cen_BKRQ_MW14 + cen_BKRQ_MW15 + cen_BKRQ_MW16 + cen_BKRQ_MW17

centrack_Agg_LW <- WRbase_LW + cenli_CCBS_LW_1 + cenli_CCBS_LW_2 + cenli_CCBS_LW_3 + cenli_CCBS_LW_4 + cenli_CCBS_LW_5 + cenli_CCBS_LW_6 + cenli_CCBS_LW_7 + cenli_CCBS_LW_8 + cenli_CCBS_LW_9 + cenli_CCBS_LW_10 + cenli_CCBS_LW_11 + cenli_CCBS_LW_12 + cenli_CCBS_LW_13 + cenli_CCBS_LW_14 + cenli_CCBS_LW_15 + cenli_CCBS_LW_16 + cen_CCBS_LW1 + cen_CCBS_LW2 + cen_CCBS_LW3 + cen_CCBS_LW4 + cen_CCBS_LW5 + cen_CCBS_LW6 + cen_CCBS_LW7 + cen_CCBS_LW8 + cen_CCBS_LW9 + cen_CCBS_LW10 + cen_CCBS_LW11 + cen_CCBS_LW12 + cen_CCBS_LW13 + cen_CCBS_LW14 + cen_CCBS_LW15 + cen_CCBS_LW16 + cen_CCBS_LW17 + cenli_BKRQ_LW_1 + cenli_BKRQ_LW_2 + cenli_BKRQ_LW_3 + cenli_BKRQ_LW_4 + cenli_BKRQ_LW_5 + cenli_BKRQ_LW_6 + cenli_BKRQ_LW_7 + cenli_BKRQ_LW_8 + cenli_BKRQ_LW_9 + cenli_BKRQ_LW_10 + cenli_BKRQ_LW_11 + cenli_BKRQ_LW_12 + cenli_BKRQ_LW_13 + cenli_BKRQ_LW_14 + cenli_BKRQ_LW_15 + cenli_BKRQ_LW_16 + cen_BKRQ_LW1 + cen_BKRQ_LW2 + cen_BKRQ_LW3 + cen_BKRQ_LW4 + cen_BKRQ_LW5 + cen_BKRQ_LW6 + cen_BKRQ_LW7 + cen_BKRQ_LW8 + cen_BKRQ_LW9 + cen_BKRQ_LW10 + cen_BKRQ_LW11 + cen_BKRQ_LW12 + cen_BKRQ_LW13 + cen_BKRQ_LW14 + cen_BKRQ_LW15 + cen_BKRQ_LW16

centrack_Agg_CA <- WRbase_CA + cenli_CCBS_CA_1 + cenli_CCBS_CA_2 + cenli_CCBS_CA_3 + cenli_CCBS_CA_4 + cenli_CCBS_CA_5 + cenli_CCBS_CA_6 + cenli_CCBS_CA_7 + cenli_CCBS_CA_8 + cenli_CCBS_CA_9 + cenli_CCBS_CA_10 + cenli_CCBS_CA_11 + cenli_CCBS_CA_12 + cenli_CCBS_CA_13 + cenli_CCBS_CA_14 + cenli_CCBS_CA_15 + cenli_CCBS_CA_16 + cen_CCBS_CA1 + cen_CCBS_CA2 + cen_CCBS_CA3 + cen_CCBS_CA4 + cen_CCBS_CA5 + cen_CCBS_CA6 + cen_CCBS_CA7 + cen_CCBS_CA8 + cen_CCBS_CA9 + cen_CCBS_CA10 + cen_CCBS_CA11 + cen_CCBS_CA12 + cen_CCBS_CA13 + cen_CCBS_CA14 + cen_CCBS_CA15 + cen_CCBS_CA16 + cenli_BKRQ_CA_1 + cenli_BKRQ_CA_2 + cenli_BKRQ_CA_3 + cenli_BKRQ_CA_4 + cenli_BKRQ_CA_5 + cenli_BKRQ_CA_6 + cenli_BKRQ_CA_7 + cenli_BKRQ_CA_8 + cenli_BKRQ_CA_9 + cenli_BKRQ_CA_10 + cenli_BKRQ_CA_11 + cenli_BKRQ_CA_12 + cenli_BKRQ_CA_13 + cenli_BKRQ_CA_14 + cenli_BKRQ_CA_15 + cenli_BKRQ_CA_16 + cen_BKRQ_CA1 + cen_BKRQ_CA2 + cen_BKRQ_CA3 + cen_BKRQ_CA4 + cen_BKRQ_CA5 + cen_BKRQ_CA6 + cen_BKRQ_CA7 + cen_BKRQ_CA8 + cen_BKRQ_CA9 + cen_BKRQ_CA10 + cen_BKRQ_CA11 + cen_BKRQ_CA12 + cen_BKRQ_CA13 + cen_BKRQ_CA14 + cen_BKRQ_CA15 + cen_BKRQ_CA16

centrack_Agg_SU <- WRbase_SU + cenli_CCBS_SU_1 + cenli_CCBS_SU_2 + cenli_CCBS_SU_3 + cenli_CCBS_SU_4 + cenli_CCBS_SU_5 + cenli_CCBS_SU_6 + cenli_CCBS_SU_7 + cenli_CCBS_SU_8 + cenli_CCBS_SU_9 + cenli_CCBS_SU_10 + cenli_CCBS_SU_11 + cenli_CCBS_SU_12 + cenli_CCBS_SU_13 + cenli_CCBS_SU_14 + cenli_CCBS_SU_15 + cenli_CCBS_SU_16 + cen_CCBS_SU1 + cen_CCBS_SU2 + cen_CCBS_SU3 + cen_CCBS_SU4 + cen_CCBS_SU5 + cen_CCBS_SU6 + cen_CCBS_SU7 + cen_CCBS_SU8 + cen_CCBS_SU9 + cen_CCBS_SU10 + cen_CCBS_SU11 + cen_CCBS_SU12 + cen_CCBS_SU13 + cen_CCBS_SU14 + cen_CCBS_SU15 + cen_CCBS_SU16 + cenli_BKRQ_SU_1 + cenli_BKRQ_SU_2 + cenli_BKRQ_SU_3 + cenli_BKRQ_SU_4 + cenli_BKRQ_SU_5 + cenli_BKRQ_SU_6 + cenli_BKRQ_SU_7 + cenli_BKRQ_SU_8 + cenli_BKRQ_SU_9 + cenli_BKRQ_SU_10 + cenli_BKRQ_SU_11 + cenli_BKRQ_SU_12 + cenli_BKRQ_SU_13 + cenli_BKRQ_SU_14 + cenli_BKRQ_SU_15 + cenli_BKRQ_SU_16 + cen_BKRQ_SU1 + cen_BKRQ_SU2 + cen_BKRQ_SU3 + cen_BKRQ_SU4 + cen_BKRQ_SU5 + cen_BKRQ_SU6 + cen_BKRQ_SU7 + cen_BKRQ_SU8 + cen_BKRQ_SU9 + cen_BKRQ_SU10 + cen_BKRQ_SU11 + cen_BKRQ_SU12 + cen_BKRQ_SU13 + cen_BKRQ_SU14 + cen_BKRQ_SU15 + cen_BKRQ_SU16

centrack_Agg_RU <- WRbase_RU + cenli_CCBS_RU_1 + cenli_CCBS_RU_2 + cenli_CCBS_RU_3 + cenli_CCBS_RU_4 + cenli_CCBS_RU_5 + cen_CCBS_RU1 + cen_CCBS_RU2 + cen_CCBS_RU3 + cen_CCBS_RU4 + cen_CCBS_RU5 + cenli_BKRQ_RU_1 + cenli_BKRQ_RU_2 + cenli_BKRQ_RU_3 + cenli_BKRQ_RU_4 + cenli_BKRQ_RU_5 + cenli_BKRQ_RU_6 + cenli_BKRQ_RU_7 + cenli_BKRQ_RU_8 + cenli_BKRQ_RU_9 + cenli_BKRQ_RU_10 + cenli_BKRQ_RU_11 + cenli_BKRQ_RU_12 + cenli_BKRQ_RU_13 + cenli_BKRQ_RU_14 + cen_BKRQ_RU1 + cen_BKRQ_RU2 + cen_BKRQ_RU3 + cen_BKRQ_RU4 + cen_BKRQ_RU5 + cen_BKRQ_RU6 + cen_BKRQ_RU7 + cen_BKRQ_RU8 + cen_BKRQ_RU9 + cen_BKRQ_RU10 + cen_BKRQ_RU11 + cen_BKRQ_RU12 + cen_BKRQ_RU13 + cen_BKRQ_RU14 + cen_BKRQ_RU15


```

# Using Tmap pacakge to put all the above together into arranged panels

```{r , echo=FALSE}

CCBS_EW_ps1 <- tmap_arrange(centrack_CCBS_EW, CCBS_EWa1, CCBS_EWa2, CCBS_EWa3, CCBS_EWa4, CCBS_EWa5)
CCBS_EW_ps2 <- tmap_arrange(CCBS_EWa6, CCBS_EWa7, CCBS_EWa8, CCBS_EWa9, CCBS_EWa10, CCBS_EWa11)
CCBS_EW_ps3 <- tmap_arrange(CCBS_EWa12, CCBS_EWa13, CCBS_EWa14, CCBS_EWa15, CCBS_EWa16)
CCBS_EW_ps4 <- tmap_arrange(CCBS_EWa17, CCBS_EWa18)

CCBS_MW_ps1 <- tmap_arrange(centrack_CCBS_MW, CCBS_MWa1, CCBS_MWa2, CCBS_MWa3, CCBS_MWa4, CCBS_MWa5)
CCBS_MW_ps2 <- tmap_arrange(CCBS_MWa6, CCBS_MWa7, CCBS_MWa8, CCBS_MWa9, CCBS_MWa10, CCBS_MWa11)
CCBS_MW_ps3 <- tmap_arrange(CCBS_MWa12, CCBS_MWa13, CCBS_MWa14, CCBS_MWa15, CCBS_MWa16)
CCBS_MW_ps4 <- tmap_arrange(CCBS_MWa17)

CCBS_LW_ps1 <- tmap_arrange(centrack_CCBS_LW, CCBS_LWa1, CCBS_LWa2, CCBS_LWa3, CCBS_LWa4, CCBS_LWa5)
CCBS_LW_ps2 <- tmap_arrange(CCBS_LWa6, CCBS_LWa7, CCBS_LWa8, CCBS_LWa9, CCBS_LWa10, CCBS_LWa11)
CCBS_LW_ps3 <- tmap_arrange(CCBS_LWa12, CCBS_LWa13, CCBS_LWa14, CCBS_LWa15, CCBS_LWa16)
CCBS_LW_ps4 <- tmap_arrange(CCBS_LWa17)

CCBS_CA_ps1 <- tmap_arrange(centrack_CCBS_CA, CCBS_CAa1, CCBS_CAa2, CCBS_CAa3, CCBS_CAa4, CCBS_CAa5)
CCBS_CA_ps2 <- tmap_arrange(CCBS_CAa6, CCBS_CAa7, CCBS_CAa8, CCBS_CAa9, CCBS_CAa10, CCBS_CAa11)
CCBS_CA_ps3 <- tmap_arrange(CCBS_CAa12, CCBS_CAa13, CCBS_CAa14, CCBS_CAa15, CCBS_CAa16)

CCBS_SU_ps1 <- tmap_arrange(centrack_CCBS_SU, CCBS_SUa1, CCBS_SUa2, CCBS_SUa3, CCBS_SUa4, CCBS_SUa5)
CCBS_SU_ps2 <- tmap_arrange(CCBS_SUa6, CCBS_SUa7, CCBS_SUa8, CCBS_SUa9, CCBS_SUa10, CCBS_SUa11)
CCBS_SU_ps3 <- tmap_arrange(CCBS_SUa12, CCBS_SUa13, CCBS_SUa14, CCBS_SUa15, CCBS_SUa16)

CCBS_RU_ps1 <- tmap_arrange(centrack_CCBS_RU, CCBS_RUa1, CCBS_RUa2, CCBS_RUa3, CCBS_RUa4, CCBS_RUa5)
CCBS_RU_ps2 <- tmap_arrange(CCBS_RUa6, CCBS_RUa7, CCBS_RUa8, CCBS_RUa9, CCBS_RUa10, CCBS_RUa11)
CCBS_RU_ps3 <- tmap_arrange(CCBS_RUa12, CCBS_RUa13, CCBS_RUa14, CCBS_RUa16)


BKRQ_EW_ps1 <- tmap_arrange(centrack_BKRQ_EW, BKRQ_EWa1, BKRQ_EWa2, BKRQ_EWa3, BKRQ_EWa4, BKRQ_EWa5)
BKRQ_EW_ps2 <- tmap_arrange(BKRQ_EWa6, BKRQ_EWa7, BKRQ_EWa8, BKRQ_EWa9, BKRQ_EWa10, BKRQ_EWa11)
BKRQ_EW_ps3 <- tmap_arrange(BKRQ_EWa12, BKRQ_EWa13, BKRQ_EWa14, BKRQ_EWa15)

BKRQ_MW_ps1 <- tmap_arrange(centrack_BKRQ_MW, BKRQ_MWa1, BKRQ_MWa2, BKRQ_MWa3, BKRQ_MWa4, BKRQ_MWa5)
BKRQ_MW_ps2 <- tmap_arrange(BKRQ_MWa6, BKRQ_MWa7, BKRQ_MWa8, BKRQ_MWa9, BKRQ_MWa10, BKRQ_MWa11)
BKRQ_MW_ps3 <- tmap_arrange(BKRQ_MWa12, BKRQ_MWa13, BKRQ_MWa14, BKRQ_MWa15, BKRQ_MWa16)
BKRQ_MW_ps4 <- tmap_arrange(BKRQ_MWa17)

BKRQ_LW_ps1 <- tmap_arrange(centrack_BKRQ_LW, BKRQ_LWa1, BKRQ_LWa2, BKRQ_LWa3, BKRQ_LWa4, BKRQ_LWa5)
BKRQ_LW_ps2 <- tmap_arrange(BKRQ_LWa6, BKRQ_LWa7, BKRQ_LWa8, BKRQ_LWa9, BKRQ_LWa10, BKRQ_LWa11)
BKRQ_LW_ps3 <- tmap_arrange(BKRQ_LWa12, BKRQ_LWa13, BKRQ_LWa14, BKRQ_LWa15, BKRQ_LWa16)

BKRQ_CA_ps1 <- tmap_arrange(centrack_BKRQ_CA, BKRQ_CAa1, BKRQ_CAa2, BKRQ_CAa3, BKRQ_CAa4, BKRQ_CAa5)
BKRQ_CA_ps2 <- tmap_arrange(BKRQ_CAa6, BKRQ_CAa7, BKRQ_CAa8, BKRQ_CAa9, BKRQ_CAa10, BKRQ_CAa11)
BKRQ_CA_ps3 <- tmap_arrange(BKRQ_CAa12, BKRQ_CAa13, BKRQ_CAa14, BKRQ_CAa15, BKRQ_CAa16)

BKRQ_SU_ps1 <- tmap_arrange(centrack_BKRQ_SU, BKRQ_SUa1, BKRQ_SUa2, BKRQ_SUa3, BKRQ_SUa4, BKRQ_SUa5)
BKRQ_SU_ps2 <- tmap_arrange(BKRQ_SUa6, BKRQ_SUa7, BKRQ_SUa8, BKRQ_SUa9, BKRQ_SUa10, BKRQ_SUa11)
BKRQ_SU_ps3 <- tmap_arrange(BKRQ_SUa12, BKRQ_SUa13, BKRQ_SUa14, BKRQ_SUa15, BKRQ_SUa16)

BKRQ_RU_ps1 <- tmap_arrange(centrack_BKRQ_RU, BKRQ_RUa1, BKRQ_RUa2, BKRQ_RUa3, BKRQ_RUa4, BKRQ_RUa5)
BKRQ_RU_ps2 <- tmap_arrange(BKRQ_RUa6, BKRQ_RUa7, BKRQ_RUa8, BKRQ_RUa9, BKRQ_RUa10, BKRQ_RUa11)
BKRQ_RU_ps3 <- tmap_arrange(BKRQ_RUa12, BKRQ_RUa13, BKRQ_RUa14, BKRQ_RUa15)

udtrackAgg <- c("centrack_Agg_EW", "centrack_Agg_MW", "centrack_Agg_LW", "centrack_Agg_CA", "centrack_Agg_SU", "centrack_Agg_RU")
udtrackAggli <- list(centrack_Agg_EW, centrack_Agg_MW, centrack_Agg_LW, centrack_Agg_CA, centrack_Agg_SU, centrack_Agg_RU)

panels <- c("CCBS_EW_ps1", "CCBS_EW_ps2", "CCBS_EW_ps3", "CCBS_EW_ps4", "CCBS_MW_ps1", "CCBS_MW_ps2", "CCBS_MW_ps3", "CCBS_MW_ps4", "CCBS_LW_ps1", "CCBS_LW_ps2", "CCBS_LW_ps3", "CCBS_LW_ps4", "CCBS_CA_ps1", "CCBS_CA_ps2", "CCBS_CA_ps3", "CCBS_SU_ps1", "CCBS_SU_ps2", "CCBS_SU_ps3", "CCBS_RU_ps1", "CCBS_RU_ps2", "CCBS_RU_ps3", "BKRQ_EW_ps1", "BKRQ_EW_ps2", "BKRQ_EW_ps3", "BKRQ_MW_ps1", "BKRQ_MW_ps2", "BKRQ_MW_ps3", "BKRQ_MW_ps4", "BKRQ_LW_ps1", "BKRQ_LW_ps2", "BKRQ_LW_ps3", "BKRQ_CA_ps1", "BKRQ_CA_ps2", "BKRQ_CA_ps3", "BKRQ_SU_ps1", "BKRQ_SU_ps2", "BKRQ_SU_ps3", "BKRQ_RU_ps1", "BKRQ_RU_ps2", "BKRQ_RU_ps3")

panelsl <- list(CCBS_EW_ps1, CCBS_EW_ps2, CCBS_EW_ps3, CCBS_EW_ps4, CCBS_MW_ps1, CCBS_MW_ps2, CCBS_MW_ps3, CCBS_MW_ps4, CCBS_LW_ps1, CCBS_LW_ps2, CCBS_LW_ps3, CCBS_LW_ps4, CCBS_CA_ps1, CCBS_CA_ps2, CCBS_CA_ps3, CCBS_SU_ps1, CCBS_SU_ps2, CCBS_SU_ps3, CCBS_RU_ps1, CCBS_RU_ps2, CCBS_RU_ps3, BKRQ_EW_ps1, BKRQ_EW_ps2, BKRQ_EW_ps3, BKRQ_MW_ps1, BKRQ_MW_ps2, BKRQ_MW_ps3, BKRQ_MW_ps4, BKRQ_LW_ps1, BKRQ_LW_ps2, BKRQ_LW_ps3, BKRQ_CA_ps1, BKRQ_CA_ps2, BKRQ_CA_ps3, BKRQ_SU_ps1, BKRQ_SU_ps2, BKRQ_SU_ps3, BKRQ_RU_ps1, BKRQ_RU_ps2, BKRQ_RU_ps3)


for(i in 1:length(panels)){
  tmap_save(panelsl[[i]], paste0(here("Maps"),"/",panels[i],"b.png"), device = ragg::agg_png)
}

for(i in 1:length(udtrackAgg)){
  tmap_save(udtrackAggli[[i]], paste0(here("Maps"),"/",udtrackAgg[i],"b.png"), device = ragg::agg_png)
}


pdf(CCBS_EW_ps1)
CCBS_EW_ps1
dev.off()


centrack_CCBS_RU
centrack_BKRQ_RU


```

#ploting the areas (km^2) of 50% UDs over time

```{r , echo=FALSE}
BM_sUDs_areas <- list()
p = 1

for(n in 1:length(BM_sUDs)){
  for(y in 1:length(BM_sUDs[[n]])){
    BM_sUDs_areas[p] <- BM_sUDs[[n]][[y]]$area
    names(BM_sUDs_areas[[p]]) <- paste0(BM_sUDsn[n],"_",substr(names(BM_sUDs[[n]][y]), 8, 11))
    p = p+1
  }
}

BM_sUDs_areas <- data.frame(unlist(BM_sUDs_areas))

BM_sUDs_areas$BM_SY <- rownames(BM_sUDs_areas)
BM_sUDs_areas$year <- substr(BM_sUDs_areas$BM_SY, 9, 12)
BM_sUDs_areas$BM_SY <- substr(BM_sUDs_areas$BM_SY, 1, 7)
colnames(BM_sUDs_areas) <- c("area", "BM_SY","year")
rownames(BM_sUDs_areas) <- c(1:nrow(BM_sUDs_areas))
BM_sUDs_areas$loc <- substr(BM_sUDs_areas$BM_SY, 1, 4)
BM_sUDs_areas <- BM_sUDs_areas[, c(3,4,1,2)]
BM_sUDs_areas$year <- as.numeric(BM_sUDs_areas$year)


pBM = ggplot(BM_sUDs_areas, aes(x = year, y = area, color = BM_SY)) +
  geom_line()  + xlab('Years') +
  ylab('Area (km^2)') + theme_bw() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + theme(        panel.grid.major.x = element_blank(),
       panel.grid.minor.x = element_blank()) +
  scale_x_continuous(breaks = seq(min(BM_sUDs_areas$year), max(BM_sUDs_areas$year), by = 1)) +
   ggtitle("CCBS 50% UD Seasonal Areas X Year")

pBM$labels$colour <- "Study Area"


## Two Season plot
winter = c("CCBS_EW","CCBS_MW","CCBS_LW")
summer = c("CCBS_CA","CCBS_SU","CCBS_RU")


BM_sUDs_Winterareas <- subset(BM_sUDs_areas,grepl(paste0(winter, collapse = "|"), BM_SY))
BM_sUDs_Winterareas <- aggregate(BM_sUDs_Winterareas["area"],BM_sUDs_Winterareas["year"],sum)
BM_sUDs_Winterareas$season <- "winter"

BM_sUDs_Summerareas <- subset(BM_sUDs_areas,grepl(paste0(summer, collapse = "|"), BM_SY))
BM_sUDs_Summerareas <- aggregate(BM_sUDs_Summerareas["area"],BM_sUDs_Summerareas["year"],sum)
BM_sUDs_Summerareas$season <- "summer"

BM_sUDs_WS <- rbind(BM_sUDs_Winterareas,BM_sUDs_Summerareas)


pBM_SumWin = ggplot(BM_sUDs_WS, aes(x = year, y = area, color = season)) +
  geom_line()  + xlab('Years') +
  ylab('Area (km^2)') + theme_bw() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + theme(        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank()) +
  scale_x_continuous(breaks = seq(min(BM_sUDs_Winterareas$year), max(BM_sUDs_Winterareas$year), by = 1)) +
   ggtitle("CCBS 50% UD Seasonal Areas X Year")

pBM_SumWin$labels$colour <- "Season"


## Trend Roman
TR_sUDs_areas <- list()
p = 1

for(n in 1:length(TR_sUDs)){
  for(y in 1:length(TR_sUDs[[n]])){
    TR_sUDs_areas[p] <- TR_sUDs[[n]][[y]]$area
    names(TR_sUDs_areas[[p]]) <- paste0(TR_sUDsn[n],"_",substr(names(TR_sUDs[[n]][y]), 8, 11))
    p = p+1
  }
}

TR_sUDs_areas <- data.frame(unlist(TR_sUDs_areas))

TR_sUDs_areas$TR_SY <- rownames(TR_sUDs_areas)
TR_sUDs_areas$year <- substr(TR_sUDs_areas$TR_SY, 9, 12)
TR_sUDs_areas$TR_SY <- substr(TR_sUDs_areas$TR_SY, 1, 7)
colnames(TR_sUDs_areas) <- c("area", "TR_SY","year")
rownames(TR_sUDs_areas) <- c(1:nrow(TR_sUDs_areas))
TR_sUDs_areas$loc <- substr(TR_sUDs_areas$TR_SY, 1, 4)
TR_sUDs_areas <- TR_sUDs_areas[, c(3,4,1,2)]
TR_sUDs_areas$year <- as.numeric(TR_sUDs_areas$year)


pTR = ggplot(TR_sUDs_areas, aes(x = year, y = area, color = TR_SY)) +
  geom_line()  + xlab('Years') +
  ylab('Area (km^2)') + theme_bw() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + theme(        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank()) +
  scale_x_continuous(breaks = seq(min(TR_sUDs_areas$year), max(TR_sUDs_areas$year), by = 1)) +
   ggtitle("BKRQ 50% UD Seasonal Areas X Year")

pTR$labels$colour <- "Study Area"


## Two Season plot
winter = c("BKRQ_EW","BKRQ_MW","BKRQ_LW")
summer = c("BKRQ_CA","BKRQ_SU","BKRQ_RU")


TR_sUDs_Winterareas <- subset(TR_sUDs_areas,grepl(paste0(winter, collapse = "|"), TR_SY))
TR_sUDs_Winterareas <- aggregate(TR_sUDs_Winterareas["area"],TR_sUDs_Winterareas["year"],sum)
TR_sUDs_Winterareas$season <- "winter"

TR_sUDs_Summerareas <- subset(TR_sUDs_areas,grepl(paste0(summer, collapse = "|"), TR_SY))
TR_sUDs_Summerareas <- aggregate(TR_sUDs_Summerareas["area"],TR_sUDs_Summerareas["year"],sum)
TR_sUDs_Summerareas$season <- "summer"

TR_sUDs_WS <- rbind(TR_sUDs_Winterareas,TR_sUDs_Summerareas)


pTR_SumWin = ggplot(TR_sUDs_WS, aes(x = year, y = area, color = season)) +
  geom_line()  + xlab('Years') +
  ylab('Area (km^2)') + theme_bw() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + theme(        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank()) +
  scale_x_continuous(breaks = seq(min(TR_sUDs_Winterareas$year), max(TR_sUDs_Winterareas$year), by = 1)) +
   ggtitle("BKRQ 50% UD Seasonal Areas X Year")

pTR_SumWin$labels$colour <- "Season"
```